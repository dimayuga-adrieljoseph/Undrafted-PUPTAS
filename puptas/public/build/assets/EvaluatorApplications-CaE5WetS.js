import{r as n,Q as ae,k as z,j as _,l as re,d as l,o as a,b as A,u as ne,Z as ie,w as G,a as t,e as c,h as D,v as q,t as u,F as E,g as L,n as T,m as ue,p as de,f as ce,q as pe}from"./app-Db2MWlaG.js";import{E as ve}from"./EvaluatorLayout-rIvXcGuM.js";import{C as me,L as fe,a as ge,b as xe,c as he,P as be,p as we,d as ye,e as ke}from"./chart-B9tDx7Vv.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DhTmyBLd.js";const _e={class:"max-w-7xl mx-auto py-2 px-2 sm:px-4 md:px-6 lg:px-8 overflow-x-hidden overflow-y-auto"},Ee={class:"flex flex-col md:flex-row justify-between md:items-center mb-2 gap-2"},Se={class:"flex flex-wrap justify-end gap-2 items-center w-full md:w-auto"},je={class:"flex items-center border-4 border-red-400 rounded-full px-2 py-1.5 bg-white w-full sm:w-auto"},Fe={class:"relative"},Ue={key:0,class:"absolute top-full mt-2 right-0 bg-white shadow-md border border-gray-200 rounded z-50 text-sm"},Ae={xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},De=["d"],Le={class:"bg-white/20 rounded-xl shadow p-2 overflow-x-auto"},Ne={class:"text-sm text-[#4B5563] mb-2"},Me={class:"min-w-full text-base"},Pe={class:"text-left text-white font-semibold"},$e={class:"divide-y divide-gray-600"},Re=["onClick"],Ve={class:"py-2 text-[#111827] font-medium"},Ie={class:"py-2 text-white"},Be={class:"py-2"},ze={class:"flex justify-end items-center space-x-4 mt-4"},Ge=["disabled"],qe={class:"text-sm"},Te=["disabled"],Oe={key:0,class:"text-center text-gray-400 mt-4"},He={key:0,class:"fixed top-0 right-0 w-full md:w-1/3 h-full bg-white dark:bg-gray-900 p-6 z-50 shadow-xl shadow-red-200 transition duration-300 ease-in-out overflow-y-auto"},Ke={class:"mt-3 flex space-x-2 justify-end"},Qe={key:0,class:"mt-2"},Xe={key:1,class:"mt-2 flex justify-end"},We={class:"text-gray-800 dark:text-gray-200 font-medium"},Ze={class:"text-gray-700 dark:text-gray-400"},Je={class:"mt-3 text-sm"},Ye={class:"grid grid-cols-3 gap-2"},et={class:"flex items-center space-x-2 w-full"},tt=["id","onUpdate:modelValue"],st=["for"],ot={class:"w-full"},lt=["src","onClick"],at={key:1,class:"h-16 flex items-center justify-center text-[10px] italic text-gray-400 border rounded"},rt={key:0,class:"mt-4"},nt={class:"border-l-2 border-red-400 pl-3 space-y-2"},it={class:"text-sm font-semibold text-gray-900 dark:text-white"},ut={key:0,class:"text-xs text-gray-500 italic"},dt={class:"text-xs text-gray-400"},ct=["src"],N=10,pt={__name:"EvaluatorApplications",setup(vt){me.register(fe,ge,xe,he,be,we,ye,ke);const v=n(1),w=n("lastname"),m=n(""),p=n(!0),O=ae(),S=n(O.props.users||[]),d=n(null),H=n(!0),K=n(""),y=n(""),k=n({});n(""),n({visible:!1,message:""});const Q=s=>{const e=(s||"").toLowerCase();return e==="accepted"?"bg-green-100 text-green-700":e==="pending"?"bg-yellow-100 text-yellow-700":e==="rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"},j=async()=>{try{const s=await fetch("/evaluator-dashboard/applicants",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error("Failed to fetch users");S.value=await s.json()}catch(s){K.value=s.message}finally{H.value=!1}};z(()=>{j(),V()});const C=_(()=>{const s=y.value.trim().toLowerCase();return S.value.filter(e=>{var i;const r=`${e.firstname} ${e.lastname}`.toLowerCase().includes(s),b=m.value?((i=e.status)==null?void 0:i.toLowerCase())===m.value:!0;return r&&b}).sort((e,o)=>{const r=(e[w.value]||"").toString().toLowerCase(),b=(o[w.value]||"").toString().toLowerCase();return p.value?r.localeCompare(b):b.localeCompare(r)})});_(()=>y.value.trim()?C.value:S.value.slice(0,4));const M=async s=>{var e,o;try{const r=await axios.get(`/interviewer-dashboard/application/${s.id}`);d.value={...s,application:{...r.data.user.application,processes:((e=r.data.user.application)==null?void 0:e.processes)||[],program:((o=r.data.user.application)==null?void 0:o.program)||null},grades:r.data.user.grades||null},k.value=r.data.uploadedFiles||{},console.log("Full user data:",r.data.user),console.log("Grades check:",r.data.user.grades),await V(),console.log("User & files:",d.value,k.value)}catch(r){console.error("Failed to fetch user data:",r),k.value={},d.value=null}},X=()=>{d.value=null},W=s=>({file10Front:"Grade 10 Front",file11:"Grade 11 Report",file12:"Grade 12 Report",schoolId:"School ID",nonEnrollCert:"Certificate of Non-Enrollment",psa:"PSA Birth Certificate",goodMoral:"Good Moral Certificate",underOath:"Under Oath Document",photo2x2:"2x2 Photo"})[s]||s,P=n(null),F=n(!1),Z=s=>{P.value=s,F.value=!0},$=()=>{F.value=!1},f=n(!1),x=n({}),h=n(""),J=()=>{f.value=!0,x.value=[],h.value=""},Y=()=>{f.value=!1,x.value=[],h.value=""},ee=async()=>{const s=Object.keys(x.value).filter(e=>x.value[e]);if(s.length===0||!h.value.trim()){alert("Please select files and enter a return note.");return}try{await axios.post(`/dashboard/return-files/${d.value.id}`,{files:s,note:h.value.trim()}),alert("Files returned and application status logged."),f.value=!1,x.value={},h.value="",await j(),await M(d.value)}catch(e){console.error(e),alert("Return failed.")}},R=s=>typeof s=="string"?s.charAt(0).toUpperCase()+s.slice(1):"",te=s=>new Date(s).toLocaleString(),se=n([]),V=async()=>{try{const s=await axios.get("/interviewer-dashboard/programs");se.value=s.data.programs}catch(s){console.error("Failed to load programs",s)}};z(j);const I=_(()=>Math.ceil(C.value.length/N)),U=_(()=>{const s=(v.value-1)*N;return C.value.slice(s,s+N)});re([y,m,w,p],()=>{v.value=1});const oe=s=>{w.value===s?p.value=!p.value:(w.value=s,p.value=!0)},le=()=>{y.value="",m.value="",w.value="lastname",p.value=!0,v.value=1,showStatusDropdown.value=!1};return(s,e)=>(a(),l(E,null,[A(ne(ie),{title:"All Interviewer Applications"}),A(ve,null,{default:G(()=>[t("div",_e,[t("div",Ee,[e[13]||(e[13]=t("h2",{class:"text-2xl font-bold text-[#9E122C]"}," All Applications ",-1)),t("div",Se,[t("div",je,[e[11]||(e[11]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-[#9E122C] mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),D(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>y.value=o),type:"text",placeholder:"Search by name...",class:"bg-transparent border-none outline-none focus:ring-0 focus:outline-none text-sm text-[#9E122C] placeholder-gray-500 w-full"},null,512),[[q,y.value]])]),t("button",{onClick:le,class:"text-sm text-[#9E122C] border border-[#9E122C] rounded px-3 py-1.5 hover:bg-[#FDE8EA] transition"}," Clear Filters "),t("div",Fe,[t("button",{onClick:e[1]||(e[1]=o=>s.showStatusDropdown=!s.showStatusDropdown),class:"text-[#9E122C] p-2 border border-[#9E122C] rounded-full",title:"Filter"},e[12]||(e[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2a1 1 0 01-.293.707L15 12.414V19a1 1 0 01-1.447.894l-4-2A1 1 0 019 17v-4.586L3.293 6.707A1 1 0 013 6V4z"})],-1)])),s.showStatusDropdown?(a(),l("div",Ue,[t("button",{class:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:e[2]||(e[2]=o=>{m.value="",s.showStatusDropdown=!1})}," All "),t("button",{class:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:e[3]||(e[3]=o=>{m.value="accepted",s.showStatusDropdown=!1})}," Accepted "),t("button",{class:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:e[4]||(e[4]=o=>{m.value="pending",s.showStatusDropdown=!1})}," Pending "),t("button",{class:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:e[5]||(e[5]=o=>{m.value="rejected",s.showStatusDropdown=!1})}," Rejected ")])):c("",!0)]),t("button",{onClick:e[6]||(e[6]=o=>p.value=!p.value),class:"text-[#9E122C] p-2 border border-[#9E122C] rounded-full",title:"Sort"},[(a(),l("svg",Ae,[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:p.value?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"},null,8,De)]))])])]),t("div",Le,[t("div",Ne," Showing "+u(U.value.length)+" of "+u(C.value.length)+" users ",1),t("table",Me,[t("thead",null,[t("tr",Pe,[t("th",{class:"pb-2 cursor-pointer",onClick:e[7]||(e[7]=o=>oe("lastname"))}," Name "),e[14]||(e[14]=t("th",{class:"pb-2"},"Course",-1)),e[15]||(e[15]=t("th",{class:"pb-2"},"Status",-1))])]),t("tbody",$e,[(a(!0),l(E,null,L(U.value,o=>(a(),l("tr",{key:o.id,onClick:r=>M(o),class:"cursor-pointer hover:bg-white/10 backdrop-blur-sm transition"},[t("td",Ve,u(o.firstname)+" "+u(o.lastname),1),t("td",Ie,u(o.course||"—"),1),t("td",Be,[t("span",{class:T([Q(o.status),"px-2 py-1 rounded text-sm font-semibold"])},u(o.status||"Unknown"),3)])],8,Re))),128))])]),t("div",ze,[t("button",{onClick:e[8]||(e[8]=o=>v.value--),disabled:v.value===1,class:"text-sm text-[#9E122C] disabled:text-gray-900"}," Previous ",8,Ge),t("span",qe,"Page "+u(v.value)+" of "+u(I.value),1),t("button",{onClick:e[9]||(e[9]=o=>v.value++),disabled:v.value===I.value,class:"text-sm text-[#9E122C] disabled:text-gray-900"}," Next ",8,Te)]),U.value.length===0?(a(),l("p",Oe," No results found. ")):c("",!0)])]),A(ue,{name:"slide-fade"},{default:G(()=>{var o,r,b;return[d.value?(a(),l("div",He,[t("button",{class:"mt-6 px-4 py-2 rounded bg-[#9E122C] text-white hover:bg-[#EE6A43] transition",onClick:X}," Close "),t("div",Ke,[f.value?c("",!0):(a(),l("button",{key:0,onClick:J,class:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700"}," Evaluate ")),f.value?(a(),l("button",{key:1,onClick:Y,class:"px-3 py-1 bg-gray-400 text-black text-sm rounded hover:bg-gray-500"}," Cancel ")):c("",!0)]),f.value?(a(),l("div",Qe,[e[16]||(e[16]=t("label",{for:"returnNote",class:"block text-xs font-semibold mb-1"}," Return Reason / Note ",-1)),D(t("textarea",{id:"returnNote","onUpdate:modelValue":e[10]||(e[10]=i=>h.value=i),rows:"2",class:"w-full border rounded p-1 text-xs",placeholder:"Reason for returning..."},null,512),[[q,h.value]])])):c("",!0),f.value?(a(),l("div",Xe,[t("button",{onClick:ee,class:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700"}," Return Selected Files ")])):c("",!0),e[20]||(e[20]=t("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," User Information ",-1)),t("p",We," Name: "+u(d.value.lastname)+", "+u(d.value.firstname),1),t("p",Ze," Email: "+u(d.value.email),1),t("section",Je,[e[19]||(e[19]=t("h4",{class:"font-semibold mb-1 text-base"}," Uploaded Documents ",-1)),t("div",Ye,[(a(!0),l(E,null,L(k.value,(i,g)=>(a(),l("div",{key:g,class:"flex flex-col items-start space-y-1"},[t("div",et,[f.value?D((a(),l("input",{key:0,type:"checkbox",id:g,"onUpdate:modelValue":B=>x.value[g]=B,class:"h-4 w-4 mt-1"},null,8,tt)),[[de,x.value[g]]]):c("",!0),t("label",{for:g,class:"text-xs font-medium truncate w-full"},u(W(g)),9,st)]),t("div",ot,[i?(a(),l("img",{key:0,src:i,alt:"Uploaded Document",class:"h-16 w-full object-contain border rounded cursor-pointer",onClick:B=>Z(i)},null,8,lt)):(a(),l("div",at," No Image "))])]))),128))]),(b=(r=(o=d.value)==null?void 0:o.application)==null?void 0:r.processes)!=null&&b.length?(a(),l("section",rt,[e[18]||(e[18]=t("h4",{class:"font-semibold mb-2 text-base text-gray-800 dark:text-gray-200"}," Application History ",-1)),t("ul",nt,[(a(!0),l(E,null,L(d.value.application.processes,(i,g)=>(a(),l("li",{key:g,class:"relative"},[e[17]||(e[17]=t("div",{class:"absolute -left-[10px] top-1 w-3 h-3 bg-red-600 rounded-full border-2 border-white"},null,-1)),t("p",it,[ce(u(R(i.stage))+" - ",1),t("span",{class:T({"text-green-600":i.status==="completed","text-yellow-600":i.status==="in_progress","text-red-600":i.status==="returned"})},u(R(i.status)),3)]),i.notes?(a(),l("p",ut," Note: "+u(i.notes),1)):c("",!0),t("p",dt,u(te(i.created_at)),1)]))),128))])])):c("",!0)])])):c("",!0)]}),_:1}),F.value?(a(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",onClick:pe($,["self"])},[t("img",{src:P.value,alt:"Preview",class:"max-w-full max-h-full rounded shadow-lg"},null,8,ct),t("button",{onClick:$,class:"absolute top-5 right-5 text-white text-4xl font-bold hover:text-gray-300","aria-label":"Close preview"}," × ")])):c("",!0)]),_:1})],64))}},bt=Ce(pt,[["__scopeId","data-v-a450750f"]]);export{bt as default};
