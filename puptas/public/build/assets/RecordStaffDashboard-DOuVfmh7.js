import{Q as ce,r as d,p as ue,i as G,d as o,o as r,b as h,u as O,Z as pe,w as k,a as e,t as a,e as g,F as b,g as C,k as xe,f as q,n as H,q as Q,h as ge,s as fe,l as me}from"./app-DfB9M8U9.js";import"./index-5mJFNT4A.js";import{_ as he}from"./RecordStaffLayout-D8AwDtHC.js";import{C as be,L as ve,a as ye,b as we,c as _e,P as ke,p as Ce,d as je,e as Ue}from"./chart-B9tDx7Vv.js";import{_ as Ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Sidebar-CnNQZtMu.js";import"./index-4xUsyZUr.js";import"./useGlobalLoading-JbndNdYb.js";const Me={class:"flex flex-wrap justify-center gap-[6rem] px-4 py-4 max-w-full overflow-hidden"},Fe={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Le={class:"text-3xl font-bold text-gray-900"},Ae={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Se={class:"text-3xl font-bold text-gray-900"},Re={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},De={class:"text-3xl font-bold text-gray-900"},Be={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Ne={class:"text-3xl font-bold text-gray-900"},Pe={class:"py-8 px-4 md:px-6 lg:px-8 max-w-7xl mx-auto"},Ie={class:"flex flex-col md:flex-row gap-6"},Te={class:"flex-1 bg-white dark:bg-gray-800 p-6 rounded-xl shadow border-2 border-red-400"},$e={class:"grid grid-cols-5 sm:grid-cols-5 lg:grid-cols-5 gap-2"},Ve=["onClick"],ze={class:"text-gray-800 dark:text-gray-100 text-xs"},Ge={class:"text-gray-800 dark:text-gray-100 text-xs"},Oe={class:"flex-1 bg-white dark:bg-gray-800 p-6 rounded-xl shadow border-2 border-red-400"},qe={class:"flex items-center justify-between mb-4"},He={class:"min-w-full text-sm"},Qe={class:"divide-y divide-gray-200"},Xe=["onClick"],Ke={class:"py-2 text-gray-800 dark:text-gray-100"},We={class:"py-2 text-gray-800 dark:text-gray-100"},Ze={class:"py-2 text-gray-600 dark:text-gray-300"},Je={class:"py-2"},Ye={key:0,class:"fixed top-0 right-0 w-full md:w-1/3 h-full bg-white dark:bg-gray-900 p-6 z-50 shadow-xl shadow-red-200 transition duration-300 ease-in-out overflow-y-auto"},et={class:"text-gray-800 dark:text-gray-200 font-medium"},tt={class:"text-gray-700 dark:text-gray-400"},st={class:"mt-3 p-2 border rounded bg-gray-100 dark:bg-gray-800"},at={class:"text-sm text-gray-800 dark:text-gray-300"},ot={class:"mt-3 text-sm"},rt={class:"grid grid-cols-3 gap-2"},lt={class:"flex items-center space-x-2 w-full"},nt=["id","onUpdate:modelValue"],it=["for"],dt={class:"w-full"},ct=["src","onClick"],ut={key:1,class:"h-16 flex items-center justify-center text-[10px] italic text-gray-400 border rounded"},pt={key:0,class:"mt-4"},xt={class:"border-l-2 border-red-400 pl-3 space-y-2"},gt={class:"text-sm font-semibold text-gray-900 dark:text-white"},ft={key:0,class:"text-xs text-gray-500 italic"},mt={class:"text-xs text-gray-400"},ht={key:0,class:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-4 py-2 rounded shadow-lg z-50"},bt=["src"],vt={__name:"RecordStaffDashboard",props:{user:Object,allUsers:Array,summary:{type:Object,default:()=>({total:0,accepted:0,pending:0,returned:0})}},setup(X){be.register(ve,ye,we,_e,ke,Ce,je,Ue);const F=ce(),v=d(F.props.users||[]),K=d(F.props.programs||[]),y=X,l=d(null),W=d(!0),Z=d(""),j=d(""),w=d({});d("");const f=d({visible:!1,message:""}),_=(s,t=3e3)=>{f.value.message=s,f.value.visible=!0,setTimeout(()=>{f.value.visible=!1},t)},J=s=>{const t=(s||"").toLowerCase();return t==="accepted"?"bg-green-100 text-green-700":t==="pending"?"bg-yellow-100 text-yellow-700":t==="rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"},U=async()=>{try{const s=await fetch("/interviewer-dashboard/applicants",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error("Failed to fetch users");v.value=await s.json()}catch(s){Z.value=s.message}finally{W.value=!1}};ue(()=>{U(),D()});const Y=G(()=>j.value.trim()?v.value.filter(s=>s.name?s.name.toLowerCase().includes(j.value.toLowerCase()):!1):v.value),ee=G(()=>j.value.trim()?Y.value:v.value.slice(0,4)),te=async s=>{var t,u;try{const n=await axios.get(`/interviewer-dashboard/application/${s.id}`);l.value={...s,application:{...n.data.user.application,processes:((t=n.data.user.application)==null?void 0:t.processes)||[],program:((u=n.data.user.application)==null?void 0:u.program)||null},grades:n.data.user.grades||null},w.value=n.data.uploadedFiles||{},console.log("Full user data:",n.data.user),console.log("Grades check:",n.data.user.grades),await D(),console.log("User & files:",l.value,w.value)}catch(n){console.error("Failed to fetch user data:",n),w.value={},l.value=null}},se=()=>{l.value=null},ae=s=>({file10Front:"Grade 10 Front",file11:"Grade 11 Report",file12:"Grade 12 Report",schoolId:"School ID",nonEnrollCert:"Certificate of Non-Enrollment",psa:"PSA Birth Certificate",goodMoral:"Good Moral Certificate",underOath:"Under Oath Document",photo2x2:"2x2 Photo"})[s]||s,L=d(null),E=d(!1),oe=s=>{L.value=s,E.value=!0},A=()=>{E.value=!1},re=d(!1),S=d({});d("");const R=s=>typeof s=="string"?s.charAt(0).toUpperCase()+s.slice(1):"",le=s=>new Date(s).toLocaleString(),ne=async()=>{var s,t;try{await axios.post(`/record-dashboard/tag/${l.value.id}`),_("Tagged as officially enrolled."),l.value=null,await U()}catch(u){console.error("Accept failed:",u);const n=((t=(s=u.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to accept application due to an unexpected error.";_(n)}},ie=async()=>{var s,t;try{await axios.post(`/record-dashboard/untag/${l.value.id}`),_("Reverted to temporary enrolled."),l.value=null,await U()}catch(u){console.error("Revert failed:",u);const n=((t=(s=u.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to revert application due to an unexpected error.";_(n)}},de=d([]),D=async()=>{try{const s=await axios.get("/interviewer-dashboard/programs");de.value=s.data.programs}catch(s){console.error("Failed to load programs",s)}};return(s,t)=>(r(),o(b,null,[h(O(pe),{title:"Record Staff Dashboard"}),h(he,null,{default:k(()=>{var u,n,B,N;return[e("div",Me,[e("div",Fe,[t[0]||(t[0]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7h18M3 12h18M3 17h18"})])],-1)),t[1]||(t[1]=e("p",{class:"text-gray-700 text-base font-medium"}," Total Applications ",-1)),e("p",Le,a(((u=y.summary)==null?void 0:u.total)??0),1)]),e("div",Ae,[t[2]||(t[2]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),t[3]||(t[3]=e("p",{class:"text-gray-700 text-base font-medium"},"Accepted",-1)),e("p",Se,a(((n=y.summary)==null?void 0:n.accepted)??0),1)]),e("div",Re,[t[4]||(t[4]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3"})])],-1)),t[5]||(t[5]=e("p",{class:"text-gray-700 text-base font-medium"},"Pending",-1)),e("p",De,a(((B=y.summary)==null?void 0:B.pending)??0),1)]),e("div",Be,[t[6]||(t[6]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),t[7]||(t[7]=e("p",{class:"text-gray-700 text-base font-medium"},"Returned",-1)),e("p",Ne,a(((N=y.summary)==null?void 0:N.returned)??0),1)])]),e("div",Pe,[e("div",Ie,[e("div",Te,[t[8]||(t[8]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," Programs and Applications ",-1)),e("div",$e,[(r(!0),o(b,null,C(K.value,i=>(r(),o("button",{key:i.id,onClick:x=>s.goToProgram(i.id),class:"flex flex-col items-center justify-center bg-pink-100 hover:bg-pink-200 text-center p-2 rounded-[50px] shadow transition duration-200 border-2 border-pink-200"},[e("span",ze,a(i.code),1),e("span",Ge,a(i.applications_count),1)],8,Ve))),128))])]),e("div",Oe,[e("div",qe,[t[10]||(t[10]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Recent Applications ",-1)),h(O(xe),{href:"/recordstaff-applications",class:"text-sm text-[#9E122C] hover:underline hover:text-[#b51834] transition"},{default:k(()=>t[9]||(t[9]=[q(" See all ")])),_:1,__:[9]})]),e("table",He,[t[11]||(t[11]=e("thead",null,[e("tr",null,[e("th",{class:"text-left text-gray-500 pb-2"}," Last Name "),e("th",{class:"text-left text-gray-500 pb-2"}," First Name "),e("th",{class:"text-left text-gray-500 pb-2"}," Course "),e("th",{class:"text-left text-gray-500 pb-2"}," Status ")])],-1)),e("tbody",Qe,[(r(!0),o(b,null,C(ee.value,i=>{var x,m;return r(),o("tr",{key:i.id,onClick:M=>te(i),class:"cursor-pointer hover:bg-[#FBCB77]"},[e("td",Ke,a(i.lastname),1),e("td",We,a(i.firstname),1),e("td",Ze,a(((m=(x=i.application)==null?void 0:x.program)==null?void 0:m.code)||"—"),1),e("td",Je,[e("span",{class:H([J(i.status),"px-2 py-1 rounded text-xs font-semibold"])},a(i.status||"Unknown"),3)])],8,Xe)}),128))])])])]),h(Q,{name:"slide-fade"},{default:k(()=>{var i,x,m,M,P,I,T,$,V;return[l.value?(r(),o("div",Ye,[e("button",{class:"mt-6 px-4 py-2 rounded bg-[#9E122C] text-white hover:bg-[#EE6A43] transition",onClick:se}," Close "),t[16]||(t[16]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," User Information ",-1)),e("p",et," Name: "+a(l.value.lastname)+", "+a(l.value.firstname),1),e("p",tt," Email: "+a(l.value.email),1),e("div",st,[t[12]||(t[12]=e("h4",{class:"text-sm font-bold text-gray-700 dark:text-white mb-1"}," Temporary enrolled in: ",-1)),e("p",at,a((m=(x=(i=l.value)==null?void 0:i.application)==null?void 0:x.program)==null?void 0:m.code)+" - "+a((I=(P=(M=l.value)==null?void 0:M.application)==null?void 0:P.program)==null?void 0:I.name),1)]),e("div",{class:"mt-4"},[e("div",{class:"mt-4 flex justify-end space-x-2"},[e("button",{onClick:ne,class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"}," Tag: Officially Enrolled "),e("button",{onClick:ie,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," Untag ")])]),e("section",ot,[t[15]||(t[15]=e("h4",{class:"font-semibold mb-1 text-base"}," Uploaded Documents ",-1)),e("div",rt,[(r(!0),o(b,null,C(w.value,(c,p)=>(r(),o("div",{key:p,class:"flex flex-col items-start space-y-1"},[e("div",lt,[re.value?ge((r(),o("input",{key:0,type:"checkbox",id:p,"onUpdate:modelValue":z=>S.value[p]=z,class:"h-4 w-4 mt-1"},null,8,nt)),[[fe,S.value[p]]]):g("",!0),e("label",{for:p,class:"text-xs font-medium truncate w-full"},a(ae(p)),9,it)]),e("div",dt,[c?(r(),o("img",{key:0,src:c,alt:"Uploaded Document",class:"h-16 w-full object-contain border rounded cursor-pointer",onClick:z=>oe(c)},null,8,ct)):(r(),o("div",ut," No Image "))])]))),128))]),(V=($=(T=l.value)==null?void 0:T.application)==null?void 0:$.processes)!=null&&V.length?(r(),o("section",pt,[t[14]||(t[14]=e("h4",{class:"font-semibold mb-2 text-base text-gray-800 dark:text-gray-200"}," Application History ",-1)),e("ul",xt,[(r(!0),o(b,null,C(l.value.application.processes,(c,p)=>(r(),o("li",{key:p,class:"relative"},[t[13]||(t[13]=e("div",{class:"absolute -left-[10px] top-1 w-3 h-3 bg-red-600 rounded-full border-2 border-white"},null,-1)),e("p",gt,[q(a(R(c.stage))+" - ",1),e("span",{class:H({"text-green-600":c.status==="completed","text-yellow-600":c.status==="in_progress","text-red-600":c.status==="returned"})},a(R(c.status)),3)]),c.notes?(r(),o("p",ft," Note: "+a(c.notes),1)):g("",!0),e("p",mt,a(le(c.created_at)),1)]))),128))])])):g("",!0)])])):g("",!0)]}),_:1}),h(Q,{name:"fade"},{default:k(()=>[f.value.visible?(r(),o("div",ht,a(f.value.message),1)):g("",!0)]),_:1}),E.value?(r(),o("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",onClick:me(A,["self"])},[e("img",{src:L.value,alt:"Preview",class:"max-w-full max-h-full rounded shadow-lg"},null,8,bt),e("button",{onClick:A,class:"absolute top-5 right-5 text-white text-4xl font-bold hover:text-gray-300","aria-label":"Close preview"}," × ")])):g("",!0)])]}),_:1})],64))}},Mt=Ee(vt,[["__scopeId","data-v-c3842cd4"]]);export{Mt as default};
