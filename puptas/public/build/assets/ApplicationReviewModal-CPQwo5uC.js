import{j as ie,r as a,i as re,y as ue,p as pe,d as s,o as n,e as w,b as ge,a as l,t as d,F as $,f as r,h as Z,m as _,g as ee,n as ve,w as me,q as ce}from"./app-BScDaa5r.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const be={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},ye={class:"bg-gradient-to-br from-orange-200 to-red-400 dark:bg-gray-900 rounded-lg shadow-lg max-w-5xl w-full p-6 overflow-auto max-h-[90vh] relative",style:{"min-width":"700px"}},xe={key:0},ke={key:1,class:"text-red-600 dark:text-red-400"},we={class:"grid grid-cols-2 gap-8"},he={class:"mt-6"},Ce={class:"mt-4"},Fe=["value"],Ie={class:"mt-4"},Se=["value","disabled"],Me={class:"grid grid-cols-3 gap-2"},Re={class:"image-wrapper"},$e=["src"],Ne={key:1,class:"placeholder"},Ae={class:"image-wrapper"},je=["src"],Ee={key:1,class:"placeholder"},Pe={class:"image-wrapper"},Ue=["src"],De={key:1,class:"placeholder"},Ge={class:"image-wrapper"},Oe=["src"],Be={key:1,class:"placeholder"},Te={class:"image-wrapper"},Ve=["src"],ze={key:1,class:"placeholder"},Ye={class:"image-wrapper"},He=["src"],Le={key:1,class:"placeholder"},qe={class:"image-wrapper"},Je=["src"],Ke={key:1,class:"placeholder"},Qe={class:"image-wrapper"},We=["src"],Xe={key:1,class:"placeholder"},Ze={class:"image-wrapper"},_e=["src"],el={key:1,class:"placeholder"},ll={class:"image-wrapper"},ol=["src"],tl={key:1,class:"placeholder"},sl={class:"flex justify-end space-x-4 mt-6"},nl=["disabled"],al={key:0,class:"text-sm text-gray-600 mt-2"},dl={key:3},il={key:2,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50"},rl=["src"],ul={key:0,class:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-4 py-2 rounded shadow-lg z-50"},pl={__name:"ApplicationReviewModal",props:{show:Boolean,userEmail:String},emits:["close","reupload"],setup(le,{emit:oe}){const h=window.axios,te=le,se=oe;ie(()=>te.show,async i=>{i&&await R()});const f=a(""),C=a(""),F=a(!1),N=a(!1),I=a(""),t=a(null),b=a({visible:!1,message:""}),S=(i,e=3e3)=>{b.value.message=i,b.value.visible=!0,setTimeout(()=>{b.value.visible=!1},e)},M=re(()=>{var e;const i=(e=t.value)==null?void 0:e.status;return!i||["draft","returned"].includes(i)}),R=async()=>{var i;N.value=!0,I.value="";try{const e=await h.get("/user/application");t.value=e.data,console.log("Application status:",(i=t.value)==null?void 0:i.status),await de(),console.log("Setting selected:",e.data.program_id),ue(()=>{f.value=e.data.program_id??"",C.value=e.data.second_choice_id??""})}catch{I.value="Failed to load application data."}finally{N.value=!1}},P=()=>{F.value=!0,R()},A=()=>{F.value=!1},ne=async()=>{try{await h.post("/user/application/submit",{program_id:f.value,second_choice_id:C.value||null}),await R(),se("refreshDashboard"),S("Application submitted!"),setTimeout(()=>{A()},1e3)}catch{S("Failed to submit application. Choose programs before submitting.")}};pe(()=>{P(),ae.value={file10Front:null,file11:null,file12:null,schoolId:null,nonEnrollCert:null,psa:null,goodMoral:null,underOath:null,photo2x2:null}});const U=a(null),j=a(!1),u=i=>{U.value=i,j.value=!0},D=()=>{j.value=!1},ae=a({}),G=a(null),O=a(null),B=a(null),T=a(null),V=a(null),z=a(null),Y=a(null),H=a(null),L=a(null),q=a(null),p=i=>{const v={file10Front:G,file:O,file11:B,file12:T,schoolId:V,nonEnrollCert:z,psa:Y,goodMoral:H,underOath:L,photo2x2:q}[i];v&&v.value&&v.value.click()},g=async(i,e)=>{var y,x,k;const v=i.target.files[0];if(!v)return;const c=new FormData;c.append("file",v),c.append("field",e);try{const m=await h.post("/user/application/reupload",c,{headers:{"Content-Type":"multipart/form-data"}});S("File reuploaded!"),await R()}catch(m){console.error("Reupload error:",((y=m.response)==null?void 0:y.data)||m),S(((k=(x=m.response)==null?void 0:x.data)==null?void 0:k.message)||"Failed to reupload file.")}},E=a([]),de=async()=>{try{const i=await h.get("/user/eligible-programs");E.value=i.data.programs}catch{console.error("Failed to load eligible programs")}};return(i,e)=>{var v,c,y,x,k,m,J,K,Q,W,X;return n(),s($,null,[F.value?(n(),s("div",be,[l("div",ye,[l("button",{onClick:A,class:"absolute top-3 right-3 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white text-3xl font-bold","aria-label":"Close modal"}," × "),N.value?(n(),s("p",xe,"Loading application data...")):I.value?(n(),s("p",ke,d(I.value),1)):t.value?(n(),s($,{key:2},[e[63]||(e[63]=l("h2",{class:"text-xl font-bold mb-4 text-gray-900 dark:text-white"}," Review Your Application ",-1)),l("div",we,[l("div",null,[l("section",null,[e[38]||(e[38]=l("h3",{class:"font-semibold mb-2 text-gray-800 dark:text-gray-300"}," Personal Details ",-1)),l("p",null,[e[32]||(e[32]=l("strong",null,"Name:",-1)),r(" "+d(t.value.firstname)+" "+d(t.value.middlename)+" "+d(t.value.lastname),1)]),l("p",null,[e[33]||(e[33]=l("strong",null,"Birthday:",-1)),r(" "+d(t.value.birthday),1)]),l("p",null,[e[34]||(e[34]=l("strong",null,"Sex/Gender:",-1)),r(" "+d(t.value.sex),1)]),l("p",null,[e[35]||(e[35]=l("strong",null,"Contact Number:",-1)),r(" +63"+d(t.value.contactnumber),1)]),l("p",null,[e[36]||(e[36]=l("strong",null,"Address:",-1)),r(" "+d(t.value.address),1)]),l("p",null,[e[37]||(e[37]=l("strong",null,"Email:",-1)),r(" "+d(t.value.email),1)])]),l("section",he,[e[45]||(e[45]=l("h3",{class:"font-semibold mb-2 text-gray-800 dark:text-gray-300"}," High School Details ",-1)),l("p",null,[e[39]||(e[39]=l("strong",null,"School:",-1)),r(" "+d(t.value.school),1)]),l("p",null,[e[40]||(e[40]=l("strong",null,"School Address:",-1)),r(" "+d(t.value.schoolAdd),1)]),l("p",null,[e[41]||(e[41]=l("strong",null,"School Year:",-1)),r(" "+d(t.value.schoolyear),1)]),l("p",null,[e[42]||(e[42]=l("strong",null,"Date Graduated:",-1)),r(" "+d(t.value.dateGrad),1)]),l("p",null,[e[43]||(e[43]=l("strong",null,"Strand:",-1)),r(" "+d(t.value.strand),1)]),l("p",null,[e[44]||(e[44]=l("strong",null,"Track:",-1)),r(" "+d(t.value.track),1)])]),l("div",Ce,[e[47]||(e[47]=l("label",{for:"programSelect",class:"block text-sm font-medium text-gray-700"}," Choose Your Program ",-1)),Z(l("select",{id:"programSelect","onUpdate:modelValue":e[0]||(e[0]=o=>f.value=o),class:"mt-1 block w-full rounded border-gray-300 shadow-sm"},[e[46]||(e[46]=l("option",{value:""},"-- Select Program --",-1)),(n(!0),s($,null,ee(E.value,o=>(n(),s("option",{key:o.id,value:o.id},d(o.name)+" ("+d(o.code)+") ",9,Fe))),128))],512),[[_,f.value]])]),l("div",Ie,[e[49]||(e[49]=l("label",{for:"secondProgramSelect",class:"block text-sm font-medium text-gray-700"}," Choose Your Second Program ",-1)),Z(l("select",{id:"secondProgramSelect","onUpdate:modelValue":e[1]||(e[1]=o=>C.value=o),class:"mt-1 block w-full rounded border-gray-300 shadow-sm"},[e[48]||(e[48]=l("option",{value:""},"-- Select Program --",-1)),(n(!0),s($,null,ee(E.value,o=>(n(),s("option",{key:o.id,value:o.id,disabled:o.id===f.value},d(o.name)+" ("+d(o.code)+") ",9,Se))),128))],512),[[_,C.value]])])]),l("section",null,[e[60]||(e[60]=l("h3",{class:"font-semibold mb-2 text-gray-800 dark:text-gray-300"}," Uploaded Documents ",-1)),l("div",Me,[l("div",Re,[e[50]||(e[50]=l("p",null,"Grade 10 Front:",-1)),t.value.uploadedFiles.file10Front?(n(),s("img",{key:0,src:(v=t.value.uploadedFiles.file10Front)==null?void 0:v.url,alt:"Grade 10 Front",class:"max-h-20 object-contain border rounded",onClick:e[2]||(e[2]=o=>u(t.value.uploadedFiles.file10Front))},null,8,$e)):(n(),s("div",Ne," No Image Uploaded ")),l("input",{type:"file",ref_key:"file10FrontInput",ref:G,style:{display:"none"},accept:"image/*,.pdf",onChange:e[3]||(e[3]=o=>g(o,"file10Front"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[4]||(e[4]=o=>p("file10Front"))}," Reupload ")]),l("div",Ae,[e[51]||(e[51]=l("p",null,"Grade 10 Back:",-1)),t.value.uploadedFiles.file10_back?(n(),s("img",{key:0,src:(c=t.value.uploadedFiles.file10_back)==null?void 0:c.url,alt:"Grade 10 Front",class:"max-h-20 object-contain border rounded",onClick:e[5]||(e[5]=o=>u(t.value.uploadedFiles.file10_back))},null,8,je)):(n(),s("div",Ee," No Image Uploaded ")),l("input",{type:"file",ref_key:"fileInput",ref:O,style:{display:"none"},accept:"image/*,.pdf",onChange:e[6]||(e[6]=o=>g(o,"file"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[7]||(e[7]=o=>p("file"))}," Reupload ")]),l("div",Pe,[e[52]||(e[52]=l("p",null,"Grade 11 Report:",-1)),t.value.uploadedFiles.file11?(n(),s("img",{key:0,src:(y=t.value.uploadedFiles.file11)==null?void 0:y.url,alt:"Grade 11 Report",class:"max-h-20 object-contain border rounded",onClick:e[8]||(e[8]=o=>u(t.value.uploadedFiles.file11))},null,8,Ue)):(n(),s("div",De," No Image Uploaded ")),l("input",{type:"file",ref_key:"file11Input",ref:B,style:{display:"none"},accept:"image/*,.pdf",onChange:e[9]||(e[9]=o=>g(o,"file11"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[10]||(e[10]=o=>p("file11"))}," Reupload ")]),l("div",Ge,[e[53]||(e[53]=l("p",null,"Grade 12 Report:",-1)),t.value.uploadedFiles.file12?(n(),s("img",{key:0,src:(x=t.value.uploadedFiles.file12)==null?void 0:x.url,alt:"Grade 12 Report",class:"max-h-20 object-contain border rounded",onClick:e[11]||(e[11]=o=>u(t.value.uploadedFiles.file12))},null,8,Oe)):(n(),s("div",Be," No Image Uploaded ")),l("input",{type:"file",ref_key:"file12Input",ref:T,style:{display:"none"},accept:"image/*,.pdf",onChange:e[12]||(e[12]=o=>g(o,"file12"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[13]||(e[13]=o=>p("file12"))}," Reupload ")]),l("div",Te,[e[54]||(e[54]=l("p",null,"School ID:",-1)),t.value.uploadedFiles.schoolId?(n(),s("img",{key:0,src:(k=t.value.uploadedFiles.schoolId)==null?void 0:k.url,alt:"School ID",class:"max-h-20 object-contain border rounded",onClick:e[14]||(e[14]=o=>u(t.value.uploadedFiles.schoolId))},null,8,Ve)):(n(),s("div",ze," No Image Uploaded ")),l("input",{type:"file",ref_key:"schoolIdInput",ref:V,style:{display:"none"},accept:"image/*,.pdf",onChange:e[15]||(e[15]=o=>g(o,"schoolId"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[16]||(e[16]=o=>p("schoolId"))}," Reupload ")]),l("div",Ye,[e[55]||(e[55]=l("p",null,"Certificate of Non-Enrollment:",-1)),t.value.uploadedFiles.nonEnrollCert?(n(),s("img",{key:0,src:(m=t.value.uploadedFiles.nonEnrollCert)==null?void 0:m.url,alt:"Non-Enrollment Certificate",class:"max-h-20 object-contain border rounded",onClick:e[17]||(e[17]=o=>u(t.value.uploadedFiles.nonEnrollCert))},null,8,He)):(n(),s("div",Le," No Image Uploaded ")),l("input",{type:"file",ref_key:"nonEnrollCertInput",ref:z,style:{display:"none"},accept:"image/*,.pdf",onChange:e[18]||(e[18]=o=>g(o,"nonEnrollCert"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[19]||(e[19]=o=>p("nonEnrollCert"))}," Reupload ")]),l("div",qe,[e[56]||(e[56]=l("p",null,"PSA Birth Certificate:",-1)),t.value.uploadedFiles.psa?(n(),s("img",{key:0,src:(J=t.value.uploadedFiles.psa)==null?void 0:J.url,alt:"PSA",class:"max-h-20 object-contain border rounded",onClick:e[20]||(e[20]=o=>u(t.value.uploadedFiles.psa))},null,8,Je)):(n(),s("div",Ke," No Image Uploaded ")),l("input",{type:"file",ref_key:"psaInput",ref:Y,style:{display:"none"},accept:"image/*,.pdf",onChange:e[21]||(e[21]=o=>g(o,"psa"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[22]||(e[22]=o=>p("psa"))}," Reupload ")]),l("div",Qe,[e[57]||(e[57]=l("p",null,"Good Moral Certificate:",-1)),t.value.uploadedFiles.goodMoral?(n(),s("img",{key:0,src:(K=t.value.uploadedFiles.goodMoral)==null?void 0:K.url,alt:"Good Moral",class:"max-h-20 object-contain border rounded",onClick:e[23]||(e[23]=o=>u(t.value.uploadedFiles.goodMoral))},null,8,We)):(n(),s("div",Xe," No Image Uploaded ")),l("input",{type:"file",ref_key:"goodMoralInput",ref:H,style:{display:"none"},accept:"image/*,.pdf",onChange:e[24]||(e[24]=o=>g(o,"goodMoral"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[25]||(e[25]=o=>p("goodMoral"))}," Reupload ")]),l("div",Ze,[e[58]||(e[58]=l("p",null,"Under Oath Document:",-1)),t.value.uploadedFiles.underOath?(n(),s("img",{key:0,src:(Q=t.value.uploadedFiles.underOath)==null?void 0:Q.url,alt:"Under Oath",class:"max-h-20 object-contain border rounded",onClick:e[26]||(e[26]=o=>u(t.value.uploadedFiles.underOath))},null,8,_e)):(n(),s("div",el," No Image Uploaded ")),l("input",{type:"file",ref_key:"underOathInput",ref:L,style:{display:"none"},accept:"image/*,.pdf",onChange:e[27]||(e[27]=o=>g(o,"underOath"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[28]||(e[28]=o=>p("underOath"))}," Reupload ")]),l("div",ll,[e[59]||(e[59]=l("p",null,"2x2 Photo:",-1)),t.value.uploadedFiles.photo2x2?(n(),s("img",{key:0,src:(W=t.value.uploadedFiles.photo2x2)==null?void 0:W.url,alt:"2x2 Photo",class:"max-h-20 object-contain border rounded",onClick:e[29]||(e[29]=o=>u(t.value.uploadedFiles.photo2x2))},null,8,ol)):(n(),s("div",tl," No Image Uploaded ")),l("input",{type:"file",ref_key:"photo2x2Input",ref:q,style:{display:"none"},accept:"image/*,.pdf",onChange:e[30]||(e[30]=o=>g(o,"photo2x2"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[31]||(e[31]=o=>p("photo2x2"))}," Reupload ")])])])]),l("div",sl,[l("button",{onClick:A,class:"px-4 py-2 bg-gray-400 rounded hover:bg-gray-500 text-gray-800"}," Cancel "),l("button",{disabled:!M.value,onClick:ne,class:ve(["px-4 py-2 rounded text-white",{"bg-gray-400 cursor-not-allowed":!M.value,"bg-maroon-700 hover:bg-maroon-900":M.value}])}," Submit Application ",10,nl),(X=t.value)!=null&&X.status&&!M.value?(n(),s("p",al,[e[61]||(e[61]=r(" Application already ")),l("strong",null,d(t.value.status),1),e[62]||(e[62]=r(". "))])):w("",!0)])],64)):(n(),s("p",dl,"No application data found."))])])):w("",!0),F.value?w("",!0):(n(),s("button",{key:1,onClick:P,"aria-label":"Open Application Modal",class:"fixed bottom-8 right-8 bg-maroon-700 hover:bg-maroon-900 text-white p-8 rounded-full shadow-lg focus:outline-none",title:"Review Application"},e[64]||(e[64]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]))),j.value?(n(),s("div",il,[l("img",{src:U.value,alt:"Preview",class:"max-w-full max-h-full rounded shadow-lg",onClick:D},null,8,rl),l("button",{onClick:D,class:"absolute top-5 right-5 text-white text-4xl font-bold hover:text-gray-300","aria-label":"Close preview"}," × ")])):w("",!0),ge(ce,{name:"fade"},{default:me(()=>[b.value.visible?(n(),s("div",ul,d(b.value.message),1)):w("",!0)]),_:1})],64)}}},ml=fe(pl,[["__scopeId","data-v-985e24c4"]]);export{ml as default};
