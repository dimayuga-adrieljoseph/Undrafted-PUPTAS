import{r as d,j as O,k as P,c as T,o as r,w as C,a as s,b as V,d as l,e as f,n as b,t as o,F as A,g as D,f as $,i as j}from"./app-Db2MWlaG.js";import{A as K}from"./ApplicantLayout-BJd2oX9_.js";import z from"./ApplicationReviewModal-js6ccJsI.js";import"./index-DhTmyBLd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"py-12 overflow-y-auto scrollbar-hide"},Z={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},q={class:"bg-white/25 dark:bg-gray-800 shadow-xl sm:rounded-lg p-6"},G={key:0,class:"mb-6"},H={key:1,class:"overflow-x-auto scrollbar-hide mb-8"},J={class:"relative inline-block min-w-full py-4"},Q={class:"flex justify-between items-center relative"},W={class:"mt-2 text-xs text-center text-gray-700 dark:text-gray-300"},X={class:"text-xs text-center text-gray-500 dark:text-gray-400"},ee={class:"text-xs text-center text-gray-500 dark:text-gray-400"},te={class:"text-xs text-center text-gray-500 dark:text-gray-400"},se={key:0},ae={key:1},re={key:2,class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6 mb-8"},le={class:"text-xs text-center text-gray-700 dark:text-gray-300"},oe=["src","onClick"],ne=["onClick"],ie=["onChange"],de={key:3,class:"text-center py-6"},ce={key:4,class:"text-center py-6 text-gray-500"},ue={key:5,class:"text-red-500"},me={__name:"ApplicantDashboard",props:{user:Object},setup(F){const S=F,v=d(!1),c=d(!1),g=d(""),i=d({}),x=d(""),m=d([]),_=d({}),y=O(()=>Object.keys(i.value)),B=e=>e.replace(/([A-Z])/g," $1").toUpperCase(),L=e=>e.charAt(0).toUpperCase()+e.slice(1).replace("_"," "),N=e=>e.charAt(0).toUpperCase()+e.slice(1),R=e=>e?new Date(e).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",h=e=>{switch((e||"").toLowerCase()){case"draft":return"bg-gray-400 border-gray-400";case"submitted":return"bg-blue-500 border-blue-500";case"in_progress":return"bg-yellow-500 border-yellow-500";case"completed":return"bg-green-500 border-green-500";case"returned":return"bg-red-500 border-red-500";default:return"bg-gray-500 border-gray-500"}};async function w(){c.value=!0,g.value="";try{const{data:e}=await j.get("/user/application");i.value=e.uploadedFiles||{},x.value=e.status||"",m.value=e.processes||[]}catch{g.value="Could not load application data."}finally{c.value=!1}}const I=e=>{var a;return(a=_.value[e])==null?void 0:a.click()},M=async(e,a)=>{const t=e.target.files[0];if(!t)return;c.value=!0;const n=new FormData;n.append("file",t),n.append("field",a);try{const{data:u}=await j.post("/user/application/reupload",n);i.value[a]={url:u.url,status:u.status}}catch{alert("Failed to reupload file.")}finally{c.value=!1}},U=e=>{},E=()=>v.value=!1;return P(()=>{w(),v.value=!0}),(e,a)=>(r(),T(K,{title:"Applicant Dashboard"},{header:C(()=>a[0]||(a[0]=[s("h2",{class:"font-semibold text-xl text-gray-900 dark:text-gray-200 leading-tight"}," Applicant Dashboard ",-1)])),default:C(()=>[s("div",Y,[s("div",Z,[s("div",q,[a[5]||(a[5]=s("h1",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," YOUR APPLICATION TRACKER ",-1)),x.value?(r(),l("div",G,[a[1]||(a[1]=s("span",{class:"font-semibold"},"Current Status:",-1)),s("span",{class:b(`ml-2 px-3 py-1 rounded-full text-white ${h(x.value)}`)},o(N(x.value)),3)])):f("",!0),m.value.length?(r(),l("div",H,[s("div",J,[a[3]||(a[3]=s("div",{class:"absolute inset-x-0 top-6 h-px bg-gray-300 dark:bg-gray-600"},null,-1)),s("div",Q,[(r(!0),l(A,null,D(m.value,(t,n)=>(r(),l("div",{key:n,class:"flex flex-col items-center px-2"},[s("div",{class:b(["w-6 h-6 rounded-full border-2 flex items-center justify-center text-white text-xs",h(t.status)])},o(n+1),3),s("div",W,o(L(t.stage)),1),s("div",X,o(R(t.created_at)),1),s("div",ee,o(t.notes),1),s("div",te,[a[2]||(a[2]=$(" By: ")),t.performed_by?(r(),l("span",se,o(t.performed_by.firstname)+" "+o(t.performed_by.lastname),1)):(r(),l("span",ae,"System"))])]))),128))])])])):f("",!0),y.value.length?(r(),l("div",re,[(r(!0),l(A,null,D(y.value,(t,n)=>{var u,k;return r(),l("div",{key:t,class:"flex flex-col items-center space-y-2"},[s("div",{class:b(["w-6 h-6 rounded-full flex items-center justify-center text-white text-xs",h((u=i.value[t])==null?void 0:u.status)])},o(n+1),3),s("div",le,o(B(t)),1),s("div",null,[(k=i.value[t])!=null&&k.url?(r(),l("img",{key:0,src:i.value[t].url,alt:"Preview",class:"w-12 h-12 object-cover rounded cursor-pointer border",onClick:p=>U(i.value[t].url)},null,8,oe)):(r(),l("button",{key:1,onClick:p=>I(t),class:"text-blue-600 text-xs"}," Upload ",8,ne)),s("input",{type:"file",ref_for:!0,ref:p=>_.value[t]=p,class:"hidden",onChange:p=>M(p,t)},null,40,ie)])])}),128))])):f("",!0),c.value?(r(),l("div",de,a[4]||(a[4]=[s("span",{class:"animate-pulse text-gray-600 dark:text-gray-300"}," Loadingâ€¦ ",-1)]))):y.value.length?g.value?(r(),l("div",ue,o(g.value),1)):f("",!0):(r(),l("div",ce," No files to display. "))]),V(z,{show:v.value,userEmail:S.user.email,onClose:E,onRefreshDashboard:w},null,8,["show","userEmail"])])])]),_:1}))}};export{me as default};
