import{r as p,p as et,i as G,d as l,o as n,b as m,u as w,Z as st,w as _,a as t,t as a,e as g,k as at,f as T,F as b,g as k,n as z,q as ot,h as rt,s as lt,l as nt}from"./app-BScDaa5r.js";import{L as dt}from"./index-BmiYyJBB.js";import{_ as it}from"./AppLayout-9pT27ufr.js";import{C as ct,L as ut,a as pt,b as xt,c as mt,P as gt,p as ft,d as ht,e as bt}from"./chart-B9tDx7Vv.js";import{_ as yt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Sidebar-BCBaA1aj.js";import"./index-Z-NJ8KKZ.js";import"./useGlobalLoading-BL86BHNh.js";const vt={class:"flex flex-wrap justify-center gap-[6rem] px-4 py-4 max-w-full overflow-hidden"},wt={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},_t={class:"text-3xl font-bold text-gray-900"},kt={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Ct={class:"text-3xl font-bold text-gray-900"},Mt={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Et={class:"text-3xl font-bold text-gray-900"},jt={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Ut={class:"text-3xl font-bold text-gray-900"},Dt={class:"py-8 px-4 md:px-6 lg:px-8 max-w-7xl mx-auto"},Lt={class:"flex flex-col md:flex-row gap-6"},At={class:"flex-1 bg-white dark:bg-gray-800 p-6 rounded-xl shadow border-2 border-red-400"},Bt={class:"flex-1 bg-white dark:bg-gray-800 p-6 rounded-xl shadow border-2 border-red-400"},Ft={class:"flex items-center justify-between mb-4"},It={class:"min-w-full text-sm"},St={class:"divide-y divide-gray-200"},Nt=["onClick"],Rt={class:"py-2 text-gray-800 dark:text-gray-100"},Pt={class:"py-2 text-gray-800 dark:text-gray-100"},Ot={class:"py-2 text-gray-600 dark:text-gray-300"},Vt={class:"py-2"},Gt={key:0,class:"fixed top-0 right-0 w-full md:w-1/3 h-full bg-white dark:bg-gray-900 p-6 z-50 shadow-xl shadow-red-200 transition duration-300 ease-in-out overflow-y-auto"},Tt={class:"text-gray-800 dark:text-gray-200 font-medium"},zt={class:"text-gray-700 dark:text-gray-400"},$t={class:"text-sm text-gray-700 dark:text-gray-300"},qt={class:"text-sm text-gray-700 dark:text-gray-300"},Ht={class:"text-sm text-gray-700 dark:text-gray-300"},Xt={class:"mt-3 p-2 border rounded bg-gray-100 dark:bg-gray-800"},Kt={class:"text-sm text-gray-800 dark:text-gray-300"},Qt={class:"mt-3 text-sm"},Wt={class:"grid grid-cols-3 gap-2"},Zt={class:"flex items-center space-x-2 w-full"},Jt=["id","onUpdate:modelValue"],Yt=["for"],te={class:"w-full"},ee=["src","onClick"],se={key:1,class:"h-16 flex items-center justify-center text-[10px] italic text-gray-400 border rounded"},ae={key:0,class:"mt-4"},oe={class:"border-l-2 border-red-400 pl-3 space-y-2"},re={class:"text-sm font-semibold text-gray-900 dark:text-white"},le={key:0,class:"text-xs text-gray-500 italic"},ne={class:"text-xs text-gray-400"},de=["src"],ie={__name:"Dashboard",props:{user:Object,allUsers:Array,summary:{type:Object,default:()=>({total:0,accepted:0,pending:0,returned:0})},chartData:{type:Object,default:()=>({submitted:[],accepted:[],returned:[]})},years:Array},setup($){ct.register(ut,pt,xt,mt,gt,ft,ht,bt);const c=$,f=p([]),o=p(null),q=p(!0),H=p(""),y=p(""),h=p({}),X=s=>{const e=(s||"").toLowerCase();return e==="accepted"?"bg-green-100 text-green-700":e==="pending"?"bg-yellow-100 text-yellow-700":e==="returned"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"},K=async()=>{try{const s=await fetch("/dashboard/users",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error("Failed to fetch users");f.value=await s.json()}catch(s){H.value=s.message}finally{q.value=!1}};et(()=>{K()});const Q=G(()=>y.value.trim()?f.value.filter(s=>s.name?s.name.toLowerCase().includes(y.value.toLowerCase()):!1):f.value),W=G(()=>y.value.trim()?Q.value:f.value.slice(0,4)),Z=async s=>{var e,x;try{const i=await axios.get(`/admin-dashboard/user-files/${s.id}`);o.value={...s,application:{...i.data.user.application,processes:((e=i.data.user.application)==null?void 0:e.processes)||[]},grades:i.data.user.grades||null},h.value=i.data.uploadedFiles||{},console.log("User & files:",o.value,h.value),console.log("processes:",o.processes),console.log("Processes:",(x=o.value.application)==null?void 0:x.processes)}catch(i){console.error("Failed to fetch user data:",i),h.value={},o.value=null}},J=s=>({file10Front:"Grade 10 Front",file11:"Grade 11 Report",file12:"Grade 12 Report",schoolId:"School ID",nonEnrollCert:"Certificate of Non-Enrollment",psa:"PSA Birth Certificate",goodMoral:"Good Moral Certificate",underOath:"Under Oath Document",photo2x2:"2x2 Photo"})[s]||s,C=s=>typeof s=="string"?s.charAt(0).toUpperCase()+s.slice(1):"",Y=s=>new Date(s).toLocaleString(),tt=()=>{o.value=null};return(s,e)=>(n(),l(b,null,[m(w(st),{title:"Dashboard"}),m(it,null,{default:_(()=>{var x,i,M,E;return[t("div",vt,[t("div",wt,[e[2]||(e[2]=t("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[t("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7h18M3 12h18M3 17h18"})])],-1)),e[3]||(e[3]=t("p",{class:"text-gray-700 text-base font-medium"}," Total Applications ",-1)),t("p",_t,a(((x=c.summary)==null?void 0:x.total)??0),1)]),t("div",kt,[e[4]||(e[4]=t("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[t("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),e[5]||(e[5]=t("p",{class:"text-gray-700 text-base font-medium"},"Accepted",-1)),t("p",Ct,a(((i=c.summary)==null?void 0:i.accepted)??0),1)]),t("div",Mt,[e[6]||(e[6]=t("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[t("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3"})])],-1)),e[7]||(e[7]=t("p",{class:"text-gray-700 text-base font-medium"},"Pending",-1)),t("p",Et,a(((M=c.summary)==null?void 0:M.pending)??0),1)]),t("div",jt,[e[8]||(e[8]=t("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[t("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),e[9]||(e[9]=t("p",{class:"text-gray-700 text-base font-medium"},"Returned",-1)),t("p",Ut,a(((E=c.summary)==null?void 0:E.returned)??0),1)])]),t("div",Dt,[t("div",Lt,[t("div",At,[e[10]||(e[10]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," Applications Overview ",-1)),m(w(dt),{"chart-data":{labels:c.chartData.years,datasets:[{label:"Submitted",data:c.chartData.submitted,borderColor:"#2563EB",backgroundColor:"rgba(37, 99, 235, 0.2)",tension:.4},{label:"Accepted",data:c.chartData.accepted,borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.2)",tension:.4},{label:"Returned",data:c.chartData.returned,borderColor:"#F59E0B",backgroundColor:"rgba(245, 158, 11, 0.2)",tension:.4}]},class:"h-60 w-full"},null,8,["chart-data"])]),t("div",Bt,[t("div",Ft,[e[12]||(e[12]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Recent Applications ",-1)),m(w(at),{href:"/applications",class:"text-sm text-[#9E122C] hover:underline hover:text-[#b51834] transition"},{default:_(()=>e[11]||(e[11]=[T(" See all ")])),_:1,__:[11]})]),t("table",It,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",{class:"text-left text-gray-500 pb-2"}," Last Name "),t("th",{class:"text-left text-gray-500 pb-2"}," First Name "),t("th",{class:"text-left text-gray-500 pb-2"}," Course "),t("th",{class:"text-left text-gray-500 pb-2"}," Status ")])],-1)),t("tbody",St,[(n(!0),l(b,null,k(W.value,r=>(n(),l("tr",{key:r.id,onClick:v=>Z(r),class:"cursor-pointer hover:bg-[#FBCB77]"},[t("td",Rt,a(r.lastname),1),t("td",Pt,a(r.firstname),1),t("td",Ot,a(r.program.code||"—"),1),t("td",Vt,[t("span",{class:z([X(r.status),"px-2 py-1 rounded text-xs font-semibold"])},a(r.status||"Unknown"),3)])],8,Nt))),128))])])])]),m(ot,{name:"slide-fade"},{default:_(()=>{var r,v,j,U,D,L,A,B,F,I,S,N,R,P,O;return[o.value?(n(),l("div",Gt,[t("button",{class:"mt-6 px-4 py-2 rounded bg-[#9E122C] text-white hover:bg-[#EE6A43] transition",onClick:tt}," Close "),e[18]||(e[18]=t("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," User Information ",-1)),t("p",Tt," Name: "+a(o.value.lastname)+", "+a(o.value.firstname),1),t("p",zt," Email: "+a(o.value.email),1),e[19]||(e[19]=t("h4",{class:"text-sm font-bold text-gray-700 dark:text-white mb-1"}," Grades ",-1)),t("p",$t," Math: "+a(((v=(r=o.value)==null?void 0:r.grades)==null?void 0:v.mathematics)??"—"),1),t("p",qt," Science: "+a(((U=(j=o.value)==null?void 0:j.grades)==null?void 0:U.science)??"—"),1),t("p",Ht," English: "+a(((L=(D=o.value)==null?void 0:D.grades)==null?void 0:L.english)??"—"),1),t("div",Xt,[e[14]||(e[14]=t("h4",{class:"text-sm font-bold text-gray-700 dark:text-white mb-1"}," Current Program for Acceptance: ",-1)),t("p",Kt,a((F=(B=(A=o.value)==null?void 0:A.application)==null?void 0:B.program)==null?void 0:F.code)+" - "+a((N=(S=(I=o.value)==null?void 0:I.application)==null?void 0:S.program)==null?void 0:N.name),1)]),t("section",Qt,[e[17]||(e[17]=t("h4",{class:"font-semibold mb-1 text-base"}," Uploaded Documents ",-1)),t("div",Wt,[(n(!0),l(b,null,k(h.value,(d,u)=>(n(),l("div",{key:u,class:"flex flex-col items-start space-y-1"},[t("div",Zt,[s.isEvaluating?rt((n(),l("input",{key:0,type:"checkbox",id:u,"onUpdate:modelValue":V=>s.filesToReturn[u]=V,class:"h-4 w-4 mt-1"},null,8,Jt)),[[lt,s.filesToReturn[u]]]):g("",!0),t("label",{for:u,class:"text-xs font-medium truncate w-full"},a(J(u)),9,Yt)]),t("div",te,[d?(n(),l("img",{key:0,src:d,alt:"Uploaded Document",class:"h-16 w-full object-contain border rounded cursor-pointer",onClick:V=>s.openImageModal(d)},null,8,ee)):(n(),l("div",se," No Image "))])]))),128))]),(O=(P=(R=o.value)==null?void 0:R.application)==null?void 0:P.processes)!=null&&O.length?(n(),l("section",ae,[e[16]||(e[16]=t("h4",{class:"font-semibold mb-2 text-base text-gray-800 dark:text-gray-200"}," Application History ",-1)),t("ul",oe,[(n(!0),l(b,null,k(o.value.application.processes,(d,u)=>(n(),l("li",{key:u,class:"relative"},[e[15]||(e[15]=t("div",{class:"absolute -left-[10px] top-1 w-3 h-3 bg-red-600 rounded-full border-2 border-white"},null,-1)),t("p",re,[T(a(C(d.stage))+" - ",1),t("span",{class:z({"text-green-600":d.status==="completed","text-yellow-600":d.status==="in_progress","text-red-600":d.status==="returned"})},a(C(d.status)),3)]),d.notes?(n(),l("p",le," Note: "+a(d.notes),1)):g("",!0),t("p",ne,a(Y(d.created_at)),1)]))),128))])])):g("",!0)])])):g("",!0)]}),_:1}),s.showImageModal?(n(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",onClick:e[1]||(e[1]=nt((...r)=>s.closeImageModal&&s.closeImageModal(...r),["self"]))},[t("img",{src:s.previewImage,alt:"Preview",class:"max-w-full max-h-full rounded shadow-lg"},null,8,de),t("button",{onClick:e[0]||(e[0]=(...r)=>s.closeImageModal&&s.closeImageModal(...r)),class:"absolute top-5 right-5 text-white text-4xl font-bold hover:text-gray-300","aria-label":"Close preview"}," × ")])):g("",!0)])]}),_:1})],64))}},be=yt(ie,[["__scopeId","data-v-08cc7df7"]]);export{be as default};
