import{Q as ae,r as i,p as oe,i as P,d as a,o,b,u as U,Z as le,w as L,a as e,t as r,e as c,k as re,f as I,F as k,g as F,n as V,q as ne,h as O,v as ie,s as de,l as ue}from"./app-BMHqDqk-.js";import{L as ce}from"./index-nwCTK57j.js";import{_ as pe}from"./EvaluatorLayout-_Rvc28On.js";import{C as xe,L as fe,a as me,b as ge,c as ve,P as he,p as be,d as ye,e as we}from"./chart-B9tDx7Vv.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Sidebar-DKWTbHSH.js";import"./index-CzAWaHTX.js";import"./useGlobalLoading-DQXpkgxt.js";const ke={class:"flex flex-wrap justify-center gap-[6rem] px-4 py-4 max-w-full overflow-hidden"},Ce={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Ee={class:"text-3xl font-bold text-gray-900"},je={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Me={class:"text-3xl font-bold text-gray-900"},Ue={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Le={class:"text-3xl font-bold text-gray-900"},Fe={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Ae={class:"text-3xl font-bold text-gray-900"},Ne={class:"py-8 px-4 md:px-6 lg:px-8 max-w-7xl mx-auto"},Re={class:"flex flex-col md:flex-row gap-6"},Be={class:"flex-1 bg-white dark:bg-gray-800 p-6 rounded-xl shadow border-2 border-red-400"},De={class:"flex-1 bg-white dark:bg-gray-800 p-6 rounded-xl shadow border-2 border-red-400"},Se={class:"flex items-center justify-between mb-4"},Pe={class:"min-w-full text-sm"},Ie={class:"divide-y divide-gray-200"},Ve=["onClick"],Oe={class:"py-2 text-gray-800 dark:text-gray-100"},$e={class:"py-2 text-gray-800 dark:text-gray-100"},Te={class:"py-2 text-gray-600 dark:text-gray-300"},ze={class:"py-2"},Ge={key:0,class:"fixed top-0 right-0 w-full md:w-1/3 h-full bg-white dark:bg-gray-900 p-6 z-50 shadow-xl shadow-red-200 transition duration-300 ease-in-out overflow-y-auto"},qe={class:"mt-3 flex space-x-2 justify-end"},He={key:0,class:"mt-2"},Je={key:1,class:"mt-2 flex justify-end"},Qe={class:"text-gray-800 dark:text-gray-200 font-medium"},Xe={class:"text-gray-700 dark:text-gray-400"},Ke={class:"mt-3 text-sm"},We={class:"grid grid-cols-3 gap-2"},Ze={class:"flex items-center space-x-2 w-full"},Ye=["id","onUpdate:modelValue"],et=["for"],tt={class:"w-full"},st=["src","onClick"],at={key:1,class:"h-16 flex items-center justify-center text-[10px] italic text-gray-400 border rounded"},ot={key:0,class:"mt-4"},lt={class:"border-l-2 border-red-400 pl-3 space-y-2"},rt={class:"text-sm font-semibold text-gray-900 dark:text-white"},nt={key:0,class:"text-xs text-gray-500 italic"},it={class:"text-xs text-gray-400"},dt=["src"],ut={__name:"EvaluatorDashboard",props:{user:Object,allUsers:Array,summary:{type:Object,default:()=>({total:0,accepted:0,pending:0,returned:0})}},setup($){xe.register(fe,me,ge,ve,he,be,ye,we);const T=ae(),y=i(T.props.users||[]),w=$,l=i(null),z=i(!0),G=i(""),C=i(""),_=i({}),q={labels:["Jan","Feb","Mar","Apr","May","Jun"],datasets:[{label:"Submitted",data:[5,20,35,50,70,90],borderColor:"#2563EB",backgroundColor:"rgba(37, 99, 235, 0.2)",tension:.4},{label:"Accepted",data:[2,10,15,25,40,60],borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.2)",tension:.4}]},H=s=>{const t=(s||"").toLowerCase();return t==="accepted"?"bg-green-100 text-green-700":t==="pending"?"bg-yellow-100 text-yellow-700":t==="rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"},E=async()=>{try{const s=await fetch("/dashboard/users",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error("Failed to fetch users");y.value=await s.json()}catch(s){G.value=s.message}finally{z.value=!1}};oe(E);const J=P(()=>C.value.trim()?y.value.filter(s=>s.name?s.name.toLowerCase().includes(C.value.toLowerCase()):!1):y.value),Q=P(()=>C.value.trim()?J.value:y.value.slice(0,4)),j=async s=>{var t,g;try{const f=await axios.get(`/dashboard/user-files/${s.id}`);l.value={...s,application:{...f.data.user.application,processes:((t=f.data.user.application)==null?void 0:t.processes)||[]}},_.value=f.data.uploadedFiles||{},console.log("User & files:",l.value,_.value),console.log("processes:",l.processes),console.log("Processes:",(g=l.value.application)==null?void 0:g.processes)}catch(f){console.error("Failed to fetch user data:",f),_.value={},l.value=null}},X=()=>{l.value=null},K=s=>({file10Front:"Grade 10 Front",file11:"Grade 11 Report",file12:"Grade 12 Report",schoolId:"School ID",nonEnrollCert:"Certificate of Non-Enrollment",psa:"PSA Birth Certificate",goodMoral:"Good Moral Certificate",underOath:"Under Oath Document",photo2x2:"2x2 Photo"})[s]||s,A=i(null),M=i(!1),W=s=>{A.value=s,M.value=!0},N=()=>{M.value=!1},d=i(!1),x=i({}),p=i(""),Z=()=>{d.value=!0,x.value=[],p.value=""},Y=()=>{d.value=!1,x.value=[],p.value=""},ee=async()=>{const s=Object.keys(x.value).filter(t=>x.value[t]);if(s.length===0||!p.value.trim()){alert("Please select files and enter a return note.");return}try{await axios.post(`/dashboard/return-files/${l.value.id}`,{files:s,note:p.value.trim()}),alert("Files returned and application status logged."),d.value=!1,x.value={},p.value="",await E(),await j(l.value)}catch(t){console.error(t),alert("Return failed.")}},R=s=>typeof s=="string"?s.charAt(0).toUpperCase()+s.slice(1):"",te=s=>new Date(s).toLocaleString(),se=async()=>{try{await axios.post(`/evaluator/pass-application/${l.value.id}`,{note:p.value||""}),alert("Application successfully passed to the next step."),d.value=!1,x.value={},p.value="",await E(),await j(l.value)}catch(s){console.error("Error passing application:",s),alert("Failed to pass application.")}};return(s,t)=>(o(),a(k,null,[b(U(le),{title:"Dashboard"}),b(pe,null,{default:L(()=>{var g,f,B,D;return[e("div",ke,[e("div",Ce,[t[1]||(t[1]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7h18M3 12h18M3 17h18"})])],-1)),t[2]||(t[2]=e("p",{class:"text-gray-700 text-base font-medium"}," Total Applications ",-1)),e("p",Ee,r(((g=w.summary)==null?void 0:g.total)??0),1)]),e("div",je,[t[3]||(t[3]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),t[4]||(t[4]=e("p",{class:"text-gray-700 text-base font-medium"},"Accepted",-1)),e("p",Me,r(((f=w.summary)==null?void 0:f.accepted)??0),1)]),e("div",Ue,[t[5]||(t[5]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3"})])],-1)),t[6]||(t[6]=e("p",{class:"text-gray-700 text-base font-medium"},"Pending",-1)),e("p",Le,r(((B=w.summary)==null?void 0:B.pending)??0),1)]),e("div",Fe,[t[7]||(t[7]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),t[8]||(t[8]=e("p",{class:"text-gray-700 text-base font-medium"},"Returned",-1)),e("p",Ae,r(((D=w.summary)==null?void 0:D.returned)??0),1)])]),e("div",Ne,[e("div",Re,[e("div",Be,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," Applications Overview ",-1)),b(U(ce),{"chart-data":q,class:"h-60 w-full"})]),e("div",De,[e("div",Se,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Recent Applications ",-1)),b(U(re),{href:"/evaluator-applications",class:"text-sm text-[#9E122C] hover:underline hover:text-[#b51834] transition"},{default:L(()=>t[10]||(t[10]=[I(" See all ")])),_:1,__:[10]})]),e("table",Pe,[t[12]||(t[12]=e("thead",null,[e("tr",null,[e("th",{class:"text-left text-gray-500 pb-2"}," Last Name "),e("th",{class:"text-left text-gray-500 pb-2"}," First Name "),e("th",{class:"text-left text-gray-500 pb-2"}," Course "),e("th",{class:"text-left text-gray-500 pb-2"}," Status ")])],-1)),e("tbody",Ie,[(o(!0),a(k,null,F(Q.value,u=>{var v,h;return o(),a("tr",{key:u.id,onClick:n=>j(u),class:"cursor-pointer hover:bg-[#FBCB77]"},[e("td",Oe,r(u.lastname),1),e("td",$e,r(u.firstname),1),e("td",Te,r(((h=(v=u.application)==null?void 0:v.program)==null?void 0:h.code)||"—"),1),e("td",ze,[e("span",{class:V([H(u.status),"px-2 py-1 rounded text-xs font-semibold"])},r(u.status||"Unknown"),3)])],8,Ve)}),128))])])])]),b(ne,{name:"slide-fade"},{default:L(()=>{var u,v,h;return[l.value?(o(),a("div",Ge,[e("button",{class:"mt-6 px-4 py-2 rounded bg-[#9E122C] text-white hover:bg-[#EE6A43] transition",onClick:X}," Close "),e("div",qe,[d.value?c("",!0):(o(),a("button",{key:0,onClick:Z,class:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700"}," Evaluate ")),d.value?(o(),a("button",{key:1,onClick:Y,class:"px-3 py-1 bg-gray-400 text-black text-sm rounded hover:bg-gray-500"}," Cancel ")):c("",!0)]),d.value?(o(),a("div",He,[t[13]||(t[13]=e("label",{for:"returnNote",class:"block text-xs font-semibold mb-1"}," Return Reason / Note ",-1)),O(e("textarea",{id:"returnNote","onUpdate:modelValue":t[0]||(t[0]=n=>p.value=n),rows:"2",class:"w-full border rounded p-1 text-xs",placeholder:"Reason for returning..."},null,512),[[ie,p.value]])])):c("",!0),d.value?(o(),a("div",Je,[e("button",{onClick:ee,class:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700"}," Return Selected Files "),d.value&&l.value?(o(),a("button",{key:0,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",onClick:se}," Pass Application ")):c("",!0)])):c("",!0),t[17]||(t[17]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," User Information ",-1)),e("p",Qe," Name: "+r(l.value.lastname)+", "+r(l.value.firstname),1),e("p",Xe," Email: "+r(l.value.email),1),e("section",Ke,[t[16]||(t[16]=e("h4",{class:"font-semibold mb-1 text-base"}," Uploaded Documents ",-1)),e("div",We,[(o(!0),a(k,null,F(_.value,(n,m)=>(o(),a("div",{key:m,class:"flex flex-col items-start space-y-1"},[e("div",Ze,[d.value?O((o(),a("input",{key:0,type:"checkbox",id:m,"onUpdate:modelValue":S=>x.value[m]=S,class:"h-4 w-4 mt-1"},null,8,Ye)),[[de,x.value[m]]]):c("",!0),e("label",{for:m,class:"text-xs font-medium truncate w-full"},r(K(m)),9,et)]),e("div",tt,[n?(o(),a("img",{key:0,src:n,alt:"Uploaded Document",class:"h-16 w-full object-contain border rounded cursor-pointer",onClick:S=>W(n)},null,8,st)):(o(),a("div",at," No Image "))])]))),128))]),(h=(v=(u=l.value)==null?void 0:u.application)==null?void 0:v.processes)!=null&&h.length?(o(),a("section",ot,[t[15]||(t[15]=e("h4",{class:"font-semibold mb-2 text-base text-gray-800 dark:text-gray-200"}," Application History ",-1)),e("ul",lt,[(o(!0),a(k,null,F(l.value.application.processes,(n,m)=>(o(),a("li",{key:m,class:"relative"},[t[14]||(t[14]=e("div",{class:"absolute -left-[10px] top-1 w-3 h-3 bg-red-600 rounded-full border-2 border-white"},null,-1)),e("p",rt,[I(r(R(n.stage))+" - ",1),e("span",{class:V({"text-green-600":n.status==="completed","text-yellow-600":n.status==="in_progress","text-red-600":n.status==="returned"})},r(R(n.status)),3)]),n.notes?(o(),a("p",nt," Note: "+r(n.notes),1)):c("",!0),e("p",it,r(te(n.created_at)),1)]))),128))])])):c("",!0)])])):c("",!0)]}),_:1}),M.value?(o(),a("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",onClick:ue(N,["self"])},[e("img",{src:A.value,alt:"Preview",class:"max-w-full max-h-full rounded shadow-lg"},null,8,dt),e("button",{onClick:N,class:"absolute top-5 right-5 text-white text-4xl font-bold hover:text-gray-300","aria-label":"Close preview"}," × ")])):c("",!0)])]}),_:1})],64))}},bt=_e(ut,[["__scopeId","data-v-d48568ec"]]);export{bt as default};
