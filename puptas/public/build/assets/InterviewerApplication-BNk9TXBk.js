import{r as i,Q as we,p as ee,i as E,j as he,d,o as u,b as P,u as ye,Z as ke,w as te,a as t,h as $,v as Ce,e as b,t as o,F as h,g as A,n as se,q as _e,m as Se,s as Ee,f as Ae}from"./app-B9ioD5Tj.js";import{_ as Ue}from"./InterviewerLayout-CV71XbcN.js";import{C as De,L as Fe,a as Pe,b as $e,c as Le,P as Me,p as je,d as Ne,e as Ie}from"./chart-B9tDx7Vv.js";import{_ as Ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Sidebar-Dz9939gr.js";import"./index-BP1wD6F3.js";const Be={class:"max-w-7xl mx-auto py-2 px-2 sm:px-4 md:px-6 lg:px-8 overflow-x-hidden overflow-y-auto"},Te={class:"flex flex-col md:flex-row justify-between md:items-center mb-2 gap-2"},ze={class:"flex flex-wrap justify-end gap-2 items-center w-full md:w-auto"},Ge={class:"flex items-center border-4 border-red-400 rounded-full px-2 py-1.5 bg-white w-full sm:w-auto"},Re={class:"relative"},qe={key:0,class:"absolute top-full mt-2 right-0 bg-white shadow-md border border-gray-200 rounded z-50 text-sm"},He={xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ke=["d"],Oe={class:"bg-white/20 rounded-xl shadow p-2 overflow-x-auto"},Qe={class:"text-sm text-[#4B5563] mb-2"},Xe={class:"min-w-full text-base"},We={class:"text-left text-white font-semibold"},Ze={class:"divide-y divide-gray-600"},Je=["onClick"],Ye={class:"py-2 text-[#111827] font-medium"},et={class:"py-2 text-white"},tt={class:"py-2"},st={class:"flex justify-end items-center space-x-4 mt-4"},at=["disabled"],ot={class:"text-sm"},lt=["disabled"],rt={key:0,class:"text-center text-gray-400 mt-4"},nt={key:0,class:"fixed top-0 right-0 w-full md:w-1/3 h-full bg-white dark:bg-gray-900 p-6 z-50 shadow-xl shadow-red-200 transition duration-300 ease-in-out overflow-y-auto"},it={class:"text-gray-800 dark:text-gray-200 font-medium"},dt={class:"text-gray-700 dark:text-gray-400"},ut={class:"text-sm text-gray-700 dark:text-gray-300"},ct={class:"text-sm text-gray-700 dark:text-gray-300"},pt={class:"text-sm text-gray-700 dark:text-gray-300"},vt={class:"mt-3 p-2 border rounded bg-gray-100 dark:bg-gray-800"},mt={class:"text-sm text-gray-800 dark:text-gray-300"},gt={class:"mt-4"},xt=["value"],ft={class:"mt-3 text-sm"},bt={class:"grid grid-cols-3 gap-2"},wt={class:"flex items-center space-x-2 w-full"},ht=["id","onUpdate:modelValue"],yt=["for"],kt={class:"w-full"},Ct=["src","onClick"],_t={key:1,class:"h-16 flex items-center justify-center text-[10px] italic text-gray-400 border rounded"},St={key:0,class:"mt-4"},Et={class:"border-l-2 border-red-400 pl-3 space-y-2"},At={class:"text-sm font-semibold text-gray-900 dark:text-white"},Ut={key:0,class:"text-xs text-gray-500 italic"},Dt={class:"text-xs text-gray-400"},L=10,Ft={__name:"InterviewerApplication",setup(Pt){De.register(Fe,Pe,$e,Le,Me,je,Ne,Ie);const p=i(1),x=i("lastname"),v=i(""),c=i(!0),ae=we(),U=i(ae.props.users||[]),l=i(null),oe=i(!0),le=i(""),f=i(""),y=i({}),k=i(""),D=i({visible:!1,message:""}),C=(s,e=3e3)=>{D.value.message=s,D.value.visible=!0,setTimeout(()=>{D.value.visible=!1},e)},re=s=>{const e=(s||"").toLowerCase();return e==="accepted"?"bg-green-100 text-green-700":e==="pending"?"bg-yellow-100 text-yellow-700":e==="rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"},_=async()=>{try{const s=await fetch("/interviewer-dashboard/applicants",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error("Failed to fetch users");U.value=await s.json()}catch(s){le.value=s.message}finally{oe.value=!1}};ee(()=>{_(),I()});const S=E(()=>{const s=f.value.trim().toLowerCase();return U.value.filter(e=>{var w;const r=`${e.firstname} ${e.lastname}`.toLowerCase().includes(s),g=v.value?((w=e.status)==null?void 0:w.toLowerCase())===v.value:!0;return r&&g}).sort((e,a)=>{const r=(e[x.value]||"").toString().toLowerCase(),g=(a[x.value]||"").toString().toLowerCase();return c.value?r.localeCompare(g):g.localeCompare(r)})});E(()=>f.value.trim()?S.value:U.value.slice(0,4));const ne=async s=>{var e,a;try{const r=await axios.get(`/interviewer-dashboard/application/${s.id}`);l.value={...s,application:{...r.data.user.application,processes:((e=r.data.user.application)==null?void 0:e.processes)||[],program:((a=r.data.user.application)==null?void 0:a.program)||null},grades:r.data.user.grades||null},y.value=r.data.uploadedFiles||{},console.log("Full user data:",r.data.user),console.log("Grades check:",r.data.user.grades),await I(),console.log("User & files:",l.value,y.value)}catch(r){console.error("Failed to fetch user data:",r),y.value={},l.value=null}},ie=()=>{l.value=null},de=s=>({file10Front:"Grade 10 Front",file11:"Grade 11 Report",file12:"Grade 12 Report",schoolId:"School ID",nonEnrollCert:"Certificate of Non-Enrollment",psa:"PSA Birth Certificate",goodMoral:"Good Moral Certificate",underOath:"Under Oath Document",photo2x2:"2x2 Photo"})[s]||s,ue=i(null),ce=i(!1),pe=s=>{ue.value=s,ce.value=!0},ve=i(!1),M=i({});i("");const j=s=>typeof s=="string"?s.charAt(0).toUpperCase()+s.slice(1):"",me=s=>new Date(s).toLocaleString(),ge=async()=>{var s,e;try{await axios.post(`/interviewer-dashboard/accept/${l.value.id}`),C("Application accepted."),l.value=null,await _()}catch(a){console.error("Accept failed:",a);const r=((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to accept application due to an unexpected error.";C(r)}},xe=async()=>{var s,e;try{await axios.post(`/interviewer-dashboard/transfer/${l.value.id}`,{program_id:k.value}),alert("Applicant transferred successfully!"),l.value=null,k.value="",_()}catch(a){console.error("Transfer failed",a),(e=(s=a.response)==null?void 0:s.data)!=null&&e.message?C(a.response.data.message):C("Transfer failed due to an unexpected error.")}},N=i([]),I=async()=>{try{const s=await axios.get("/interviewer-dashboard/programs");N.value=s.data.programs}catch(s){console.error("Failed to load programs",s)}};ee(_);const V=E(()=>Math.ceil(S.value.length/L)),F=E(()=>{const s=(p.value-1)*L;return S.value.slice(s,s+L)});he([f,v,x,c],()=>{p.value=1});const fe=s=>{x.value===s?c.value=!c.value:(x.value=s,c.value=!0)},be=()=>{f.value="",v.value="",x.value="lastname",c.value=!0,p.value=1,showStatusDropdown.value=!1};return(s,e)=>(u(),d(h,null,[P(ye(ke),{title:"All Interviewer Applications"}),P(Ue,null,{default:te(()=>[t("div",Be,[t("div",Te,[e[13]||(e[13]=t("h2",{class:"text-2xl font-bold text-[#9E122C]"}," All Applications ",-1)),t("div",ze,[t("div",Ge,[e[11]||(e[11]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-[#9E122C] mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),$(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>f.value=a),type:"text",placeholder:"Search by name...",class:"bg-transparent border-none outline-none focus:ring-0 focus:outline-none text-sm text-[#9E122C] placeholder-gray-500 w-full"},null,512),[[Ce,f.value]])]),t("button",{onClick:be,class:"text-sm text-[#9E122C] border border-[#9E122C] rounded px-3 py-1.5 hover:bg-[#FDE8EA] transition"}," Clear Filters "),t("div",Re,[t("button",{onClick:e[1]||(e[1]=a=>s.showStatusDropdown=!s.showStatusDropdown),class:"text-[#9E122C] p-2 border border-[#9E122C] rounded-full",title:"Filter"},e[12]||(e[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2a1 1 0 01-.293.707L15 12.414V19a1 1 0 01-1.447.894l-4-2A1 1 0 019 17v-4.586L3.293 6.707A1 1 0 013 6V4z"})],-1)])),s.showStatusDropdown?(u(),d("div",qe,[t("button",{class:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:e[2]||(e[2]=a=>{v.value="",s.showStatusDropdown=!1})}," All "),t("button",{class:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:e[3]||(e[3]=a=>{v.value="accepted",s.showStatusDropdown=!1})}," Accepted "),t("button",{class:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:e[4]||(e[4]=a=>{v.value="pending",s.showStatusDropdown=!1})}," Pending "),t("button",{class:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:e[5]||(e[5]=a=>{v.value="rejected",s.showStatusDropdown=!1})}," Rejected ")])):b("",!0)]),t("button",{onClick:e[6]||(e[6]=a=>c.value=!c.value),class:"text-[#9E122C] p-2 border border-[#9E122C] rounded-full",title:"Sort"},[(u(),d("svg",He,[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:c.value?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"},null,8,Ke)]))])])]),t("div",Oe,[t("div",Qe," Showing "+o(F.value.length)+" of "+o(S.value.length)+" users ",1),t("table",Xe,[t("thead",null,[t("tr",We,[t("th",{class:"pb-2 cursor-pointer",onClick:e[7]||(e[7]=a=>fe("lastname"))}," Name "),e[14]||(e[14]=t("th",{class:"pb-2"},"Course",-1)),e[15]||(e[15]=t("th",{class:"pb-2"},"Status",-1))])]),t("tbody",Ze,[(u(!0),d(h,null,A(F.value,a=>(u(),d("tr",{key:a.id,onClick:r=>ne(a),class:"cursor-pointer hover:bg-white/10 backdrop-blur-sm transition"},[t("td",Ye,o(a.firstname)+" "+o(a.lastname),1),t("td",et,o(a.program.name||"—"),1),t("td",tt,[t("span",{class:se([re(a.status),"px-2 py-1 rounded text-sm font-semibold"])},o(a.status||"Unknown"),3)])],8,Je))),128))])]),t("div",st,[t("button",{onClick:e[8]||(e[8]=a=>p.value--),disabled:p.value===1,class:"text-sm text-[#9E122C] disabled:text-gray-900"}," Previous ",8,at),t("span",ot,"Page "+o(p.value)+" of "+o(V.value),1),t("button",{onClick:e[9]||(e[9]=a=>p.value++),disabled:p.value===V.value,class:"text-sm text-[#9E122C] disabled:text-gray-900"}," Next ",8,lt)]),F.value.length===0?(u(),d("p",rt," No results found. ")):b("",!0)])]),P(_e,{name:"slide-fade"},{default:te(()=>{var a,r,g,w,B,T,z,G,R,q,H,K,O,Q,X,W,Z,J;return[l.value?(u(),d("div",nt,[t("button",{class:"mt-6 px-4 py-2 rounded bg-[#9E122C] text-white hover:bg-[#EE6A43] transition",onClick:ie}," Close "),e[22]||(e[22]=t("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," User Information ",-1)),t("p",it," Name: "+o(l.value.lastname)+", "+o(l.value.firstname),1),t("p",dt," Email: "+o(l.value.email),1),e[23]||(e[23]=t("h4",{class:"text-sm font-bold text-gray-700 dark:text-white mb-1"}," Grades ",-1)),t("p",ut," Math: "+o(((r=(a=l.value)==null?void 0:a.grades)==null?void 0:r.mathematics)??"—"),1),t("p",ct," Science: "+o(((w=(g=l.value)==null?void 0:g.grades)==null?void 0:w.science)??"—"),1),t("p",pt," English: "+o(((T=(B=l.value)==null?void 0:B.grades)==null?void 0:T.english)??"—"),1),t("div",vt,[e[16]||(e[16]=t("h4",{class:"text-sm font-bold text-gray-700 dark:text-white mb-1"}," Current Program for Acceptance: ",-1)),t("p",mt,o((R=(G=(z=l.value)==null?void 0:z.application)==null?void 0:G.program)==null?void 0:R.code)+" - "+o((K=(H=(q=l.value)==null?void 0:q.application)==null?void 0:H.program)==null?void 0:K.name)+" ("+o((X=(Q=(O=l.value)==null?void 0:O.application)==null?void 0:Q.program)==null?void 0:X.slots)+" slots left) ",1)]),t("div",gt,[e[18]||(e[18]=t("label",{class:"block mb-1 text-sm font-semibold"},"Transfer to Program",-1)),$(t("select",{"onUpdate:modelValue":e[10]||(e[10]=n=>k.value=n),class:"w-full border rounded p-2"},[e[17]||(e[17]=t("option",{disabled:"",value:""},"-- Select Program --",-1)),(u(!0),d(h,null,A(N.value,n=>(u(),d("option",{key:n.id,value:n.id},o(n.code)+" - "+o(n.name)+" ("+o(n.slots)+" slots left) ",9,xt))),128))],512),[[Se,k.value]]),t("div",{class:"mt-4 flex justify-end space-x-2"},[t("button",{onClick:ge,class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"}," Accept "),t("button",{onClick:xe,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," Transfer ")])]),t("section",ft,[e[21]||(e[21]=t("h4",{class:"font-semibold mb-1 text-base"}," Uploaded Documents ",-1)),t("div",bt,[(u(!0),d(h,null,A(y.value,(n,m)=>(u(),d("div",{key:m,class:"flex flex-col items-start space-y-1"},[t("div",wt,[ve.value?$((u(),d("input",{key:0,type:"checkbox",id:m,"onUpdate:modelValue":Y=>M.value[m]=Y,class:"h-4 w-4 mt-1"},null,8,ht)),[[Ee,M.value[m]]]):b("",!0),t("label",{for:m,class:"text-xs font-medium truncate w-full"},o(de(m)),9,yt)]),t("div",kt,[n?(u(),d("img",{key:0,src:n,alt:"Uploaded Document",class:"h-16 w-full object-contain border rounded cursor-pointer",onClick:Y=>pe(n)},null,8,Ct)):(u(),d("div",_t," No Image "))])]))),128))]),(J=(Z=(W=l.value)==null?void 0:W.application)==null?void 0:Z.processes)!=null&&J.length?(u(),d("section",St,[e[20]||(e[20]=t("h4",{class:"font-semibold mb-2 text-base text-gray-800 dark:text-gray-200"}," Application History ",-1)),t("ul",Et,[(u(!0),d(h,null,A(l.value.application.processes,(n,m)=>(u(),d("li",{key:m,class:"relative"},[e[19]||(e[19]=t("div",{class:"absolute -left-[10px] top-1 w-3 h-3 bg-red-600 rounded-full border-2 border-white"},null,-1)),t("p",At,[Ae(o(j(n.stage))+" - ",1),t("span",{class:se({"text-green-600":n.status==="completed","text-yellow-600":n.status==="in_progress","text-red-600":n.status==="returned"})},o(j(n.status)),3)]),n.notes?(u(),d("p",Ut," Note: "+o(n.notes),1)):b("",!0),t("p",Dt,o(me(n.created_at)),1)]))),128))])])):b("",!0)])])):b("",!0)]}),_:1})]),_:1})],64))}},Vt=Ve(Ft,[["__scopeId","data-v-9c970843"]]);export{Vt as default};
