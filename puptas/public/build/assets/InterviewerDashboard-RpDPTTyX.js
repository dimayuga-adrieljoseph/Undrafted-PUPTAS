import{Q as _e,r as d,k as ee,j as te,d as l,o as n,b as x,u as E,Z as ke,w as k,a as e,t as a,e as g,x as Ce,f as se,F as f,g as C,n as ae,m as oe,h as re,s as je,p as Me,q as Ae}from"./app-Db2MWlaG.js";import{L as Ee}from"./index-CVPgBkLU.js";import{I as Ue}from"./InterviewerLayout-BMbO065x.js";import{C as Le,L as Fe,a as Ie,b as Se,c as Be,P as De,p as Pe,d as Ne,e as Te}from"./chart-B9tDx7Vv.js";import{_ as Re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DhTmyBLd.js";const Ve={class:"flex flex-wrap justify-center gap-[6rem] px-4 py-4 max-w-full overflow-hidden"},Ge={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},ze={class:"text-3xl font-bold text-gray-900"},Oe={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},$e={class:"text-3xl font-bold text-gray-900"},qe={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},He={class:"text-3xl font-bold text-gray-900"},Je={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Qe={class:"text-3xl font-bold text-gray-900"},Xe={class:"py-8 px-4 md:px-6 lg:px-8 max-w-7xl mx-auto"},Ke={class:"flex flex-col md:flex-row gap-6"},We={class:"flex-1 bg-white dark:bg-gray-800 p-6 rounded-xl shadow border-2 border-red-400"},Ze={class:"flex-1 bg-white dark:bg-gray-800 p-6 rounded-xl shadow border-2 border-red-400"},Ye={class:"flex items-center justify-between mb-4"},et={class:"min-w-full text-sm"},tt={class:"divide-y divide-gray-200"},st=["onClick"],at={class:"py-2 text-gray-800 dark:text-gray-100"},ot={class:"py-2 text-gray-800 dark:text-gray-100"},rt={class:"py-2 text-gray-600 dark:text-gray-300"},lt={class:"py-2"},nt={key:0,class:"fixed top-0 right-0 w-full md:w-1/3 h-full bg-white dark:bg-gray-900 p-6 z-50 shadow-xl shadow-red-200 transition duration-300 ease-in-out overflow-y-auto"},it={class:"text-gray-800 dark:text-gray-200 font-medium"},dt={class:"text-gray-700 dark:text-gray-400"},ct={class:"text-sm text-gray-700 dark:text-gray-300"},ut={class:"text-sm text-gray-700 dark:text-gray-300"},pt={class:"text-sm text-gray-700 dark:text-gray-300"},xt={class:"mt-3 p-2 border rounded bg-gray-100 dark:bg-gray-800"},gt={class:"text-sm text-gray-800 dark:text-gray-300"},mt={class:"mt-4"},ft=["value"],bt={class:"mt-3 text-sm"},ht={class:"grid grid-cols-3 gap-2"},vt={class:"flex items-center space-x-2 w-full"},yt=["id","onUpdate:modelValue"],wt=["for"],_t={class:"w-full"},kt=["src","onClick"],Ct={key:1,class:"h-16 flex items-center justify-center text-[10px] italic text-gray-400 border rounded"},jt={key:0,class:"mt-4"},Mt={class:"border-l-2 border-red-400 pl-3 space-y-2"},At={class:"text-sm font-semibold text-gray-900 dark:text-white"},Et={key:0,class:"text-xs text-gray-500 italic"},Ut={class:"text-xs text-gray-400"},Lt={key:0,class:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-4 py-2 rounded shadow-lg z-50"},Ft=["src"],It={__name:"InterviewerDashboard",props:{user:Object,allUsers:Array,summary:{type:Object,default:()=>({total:0,accepted:0,pending:0,returned:0})}},setup(le){Le.register(Fe,Ie,Se,Be,De,Pe,Ne,Te);const ne=_e(),b=d(ne.props.users||[]),h=le,o=d(null),ie=d(!0),de=d(""),j=d(""),v=d({}),y=d(""),m=d({visible:!1,message:""}),w=(s,t=3e3)=>{m.value.message=s,m.value.visible=!0,setTimeout(()=>{m.value.visible=!1},t)},ce={labels:["Jan","Feb","Mar","Apr","May","Jun"],datasets:[{label:"Submitted",data:[5,20,35,50,70,90],borderColor:"#2563EB",backgroundColor:"rgba(37, 99, 235, 0.2)",tension:.4},{label:"Accepted",data:[2,10,15,25,40,60],borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.2)",tension:.4}]},ue=s=>{const t=(s||"").toLowerCase();return t==="accepted"?"bg-green-100 text-green-700":t==="pending"?"bg-yellow-100 text-yellow-700":t==="rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"},_=async()=>{try{const s=await fetch("/interviewer-dashboard/applicants",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error("Failed to fetch users");b.value=await s.json()}catch(s){de.value=s.message}finally{ie.value=!1}};ee(_),ee(()=>{_(),B()});const pe=te(()=>j.value.trim()?b.value.filter(s=>s.name?s.name.toLowerCase().includes(j.value.toLowerCase()):!1):b.value),xe=te(()=>j.value.trim()?pe.value:b.value.slice(0,4)),ge=async s=>{var t,c;try{const i=await axios.get(`/interviewer-dashboard/application/${s.id}`);o.value={...s,application:{...i.data.user.application,processes:((t=i.data.user.application)==null?void 0:t.processes)||[],program:((c=i.data.user.application)==null?void 0:c.program)||null},grades:i.data.user.grades||null},v.value=i.data.uploadedFiles||{},console.log("Full user data:",i.data.user),console.log("Grades check:",i.data.user.grades),await B(),console.log("User & files:",o.value,v.value)}catch(i){console.error("Failed to fetch user data:",i),v.value={},o.value=null}},me=()=>{o.value=null},fe=s=>({file10Front:"Grade 10 Front",file11:"Grade 11 Report",file12:"Grade 12 Report",schoolId:"School ID",nonEnrollCert:"Certificate of Non-Enrollment",psa:"PSA Birth Certificate",goodMoral:"Good Moral Certificate",underOath:"Under Oath Document",photo2x2:"2x2 Photo"})[s]||s,U=d(null),M=d(!1),be=s=>{U.value=s,M.value=!0},L=()=>{M.value=!1},he=d(!1),F=d({});d("");const I=s=>typeof s=="string"?s.charAt(0).toUpperCase()+s.slice(1):"",ve=s=>new Date(s).toLocaleString(),ye=async()=>{var s,t;try{await axios.post(`/interviewer-dashboard/accept/${o.value.id}`),w("Application accepted."),o.value=null,await _()}catch(c){console.error("Accept failed:",c);const i=((t=(s=c.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to accept application due to an unexpected error.";w(i)}},we=async()=>{var s,t;try{await axios.post(`/interviewer-dashboard/transfer/${o.value.id}`,{program_id:y.value}),alert("Applicant transferred successfully!"),o.value=null,y.value="",_()}catch(c){console.error("Transfer failed",c),(t=(s=c.response)==null?void 0:s.data)!=null&&t.message?w(c.response.data.message):w("Transfer failed due to an unexpected error.")}},S=d([]),B=async()=>{try{const s=await axios.get("/interviewer-dashboard/programs");S.value=s.data.programs}catch(s){console.error("Failed to load programs",s)}};return(s,t)=>(n(),l(f,null,[x(E(ke),{title:"Interviewer Dashboard"}),x(Ue,null,{default:k(()=>{var c,i,D,P;return[e("div",Ve,[e("div",Ge,[t[1]||(t[1]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7h18M3 12h18M3 17h18"})])],-1)),t[2]||(t[2]=e("p",{class:"text-gray-700 text-base font-medium"}," Total Applications ",-1)),e("p",ze,a(((c=h.summary)==null?void 0:c.total)??0),1)]),e("div",Oe,[t[3]||(t[3]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),t[4]||(t[4]=e("p",{class:"text-gray-700 text-base font-medium"},"Accepted",-1)),e("p",$e,a(((i=h.summary)==null?void 0:i.accepted)??0),1)]),e("div",qe,[t[5]||(t[5]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3"})])],-1)),t[6]||(t[6]=e("p",{class:"text-gray-700 text-base font-medium"},"Pending",-1)),e("p",He,a(((D=h.summary)==null?void 0:D.pending)??0),1)]),e("div",Je,[t[7]||(t[7]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),t[8]||(t[8]=e("p",{class:"text-gray-700 text-base font-medium"},"Rejected",-1)),e("p",Qe,a(((P=h.summary)==null?void 0:P.returned)??0),1)])]),e("div",Xe,[e("div",Ke,[e("div",We,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," Applications Overview ",-1)),x(E(Ee),{"chart-data":ce,class:"h-60 w-full"})]),e("div",Ze,[e("div",Ye,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Recent Applications ",-1)),x(E(Ce),{href:"/interviewer-applications",class:"text-sm text-[#9E122C] hover:underline hover:text-[#b51834] transition"},{default:k(()=>t[10]||(t[10]=[se(" See all ")])),_:1,__:[10]})]),e("table",et,[t[12]||(t[12]=e("thead",null,[e("tr",null,[e("th",{class:"text-left text-gray-500 pb-2"}," Last Name "),e("th",{class:"text-left text-gray-500 pb-2"}," First Name "),e("th",{class:"text-left text-gray-500 pb-2"}," Course "),e("th",{class:"text-left text-gray-500 pb-2"}," Status ")])],-1)),e("tbody",tt,[(n(!0),l(f,null,C(xe.value,u=>(n(),l("tr",{key:u.id,onClick:A=>ge(u),class:"cursor-pointer hover:bg-[#FBCB77]"},[e("td",at,a(u.lastname),1),e("td",ot,a(u.firstname),1),e("td",rt,a(u.course||"—"),1),e("td",lt,[e("span",{class:ae([ue(u.status),"px-2 py-1 rounded text-xs font-semibold"])},a(u.status||"Unknown"),3)])],8,st))),128))])])])]),x(oe,{name:"slide-fade"},{default:k(()=>{var u,A,N,T,R,V,G,z,O,$,q,H,J,Q,X,K,W,Z;return[o.value?(n(),l("div",nt,[e("button",{class:"mt-6 px-4 py-2 rounded bg-[#9E122C] text-white hover:bg-[#EE6A43] transition",onClick:me}," Close "),t[19]||(t[19]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," User Information ",-1)),e("p",it," Name: "+a(o.value.lastname)+", "+a(o.value.firstname),1),e("p",dt," Email: "+a(o.value.email),1),t[20]||(t[20]=e("h4",{class:"text-sm font-bold text-gray-700 dark:text-white mb-1"}," Grades ",-1)),e("p",ct," Math: "+a(((A=(u=o.value)==null?void 0:u.grades)==null?void 0:A.mathematics)??"—"),1),e("p",ut," Science: "+a(((T=(N=o.value)==null?void 0:N.grades)==null?void 0:T.science)??"—"),1),e("p",pt," English: "+a(((V=(R=o.value)==null?void 0:R.grades)==null?void 0:V.english)??"—"),1),e("div",xt,[t[13]||(t[13]=e("h4",{class:"text-sm font-bold text-gray-700 dark:text-white mb-1"}," Current Program for Acceptance: ",-1)),e("p",gt,a((O=(z=(G=o.value)==null?void 0:G.application)==null?void 0:z.program)==null?void 0:O.code)+" - "+a((H=(q=($=o.value)==null?void 0:$.application)==null?void 0:q.program)==null?void 0:H.name)+" ("+a((X=(Q=(J=o.value)==null?void 0:J.application)==null?void 0:Q.program)==null?void 0:X.slots)+" slots left) ",1)]),e("div",mt,[t[15]||(t[15]=e("label",{class:"block mb-1 text-sm font-semibold"},"Transfer to Program",-1)),re(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>y.value=r),class:"w-full border rounded p-2"},[t[14]||(t[14]=e("option",{disabled:"",value:""}," -- Select Program -- ",-1)),(n(!0),l(f,null,C(S.value,r=>(n(),l("option",{key:r.id,value:r.id},a(r.code)+" - "+a(r.name)+" ("+a(r.slots)+" slots left) ",9,ft))),128))],512),[[je,y.value]]),e("div",{class:"mt-4 flex justify-end space-x-2"},[e("button",{onClick:ye,class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"}," Accept "),e("button",{onClick:we,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," Transfer ")])]),e("section",bt,[t[18]||(t[18]=e("h4",{class:"font-semibold mb-1 text-base"}," Uploaded Documents ",-1)),e("div",ht,[(n(!0),l(f,null,C(v.value,(r,p)=>(n(),l("div",{key:p,class:"flex flex-col items-start space-y-1"},[e("div",vt,[he.value?re((n(),l("input",{key:0,type:"checkbox",id:p,"onUpdate:modelValue":Y=>F.value[p]=Y,class:"h-4 w-4 mt-1"},null,8,yt)),[[Me,F.value[p]]]):g("",!0),e("label",{for:p,class:"text-xs font-medium truncate w-full"},a(fe(p)),9,wt)]),e("div",_t,[r?(n(),l("img",{key:0,src:r,alt:"Uploaded Document",class:"h-16 w-full object-contain border rounded cursor-pointer",onClick:Y=>be(r)},null,8,kt)):(n(),l("div",Ct," No Image "))])]))),128))]),(Z=(W=(K=o.value)==null?void 0:K.application)==null?void 0:W.processes)!=null&&Z.length?(n(),l("section",jt,[t[17]||(t[17]=e("h4",{class:"font-semibold mb-2 text-base text-gray-800 dark:text-gray-200"}," Application History ",-1)),e("ul",Mt,[(n(!0),l(f,null,C(o.value.application.processes,(r,p)=>(n(),l("li",{key:p,class:"relative"},[t[16]||(t[16]=e("div",{class:"absolute -left-[10px] top-1 w-3 h-3 bg-red-600 rounded-full border-2 border-white"},null,-1)),e("p",At,[se(a(I(r.stage))+" - ",1),e("span",{class:ae({"text-green-600":r.status==="completed","text-yellow-600":r.status==="in_progress","text-red-600":r.status==="returned"})},a(I(r.status)),3)]),r.notes?(n(),l("p",Et," Note: "+a(r.notes),1)):g("",!0),e("p",Ut,a(ve(r.created_at)),1)]))),128))])])):g("",!0)])])):g("",!0)]}),_:1}),x(oe,{name:"fade"},{default:k(()=>[m.value.visible?(n(),l("div",Lt,a(m.value.message),1)):g("",!0)]),_:1}),M.value?(n(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",onClick:Ae(L,["self"])},[e("img",{src:U.value,alt:"Preview",class:"max-w-full max-h-full rounded shadow-lg"},null,8,Ft),e("button",{onClick:L,class:"absolute top-5 right-5 text-white text-4xl font-bold hover:text-gray-300","aria-label":"Close preview"}," × ")])):g("",!0)])]}),_:1})],64))}},Rt=Re(It,[["__scopeId","data-v-a9a62b88"]]);export{Rt as default};
