import{j as ie,r as d,i as ue,y as pe,p as ge,d as s,o as n,e as w,b as ve,a as l,t as r,F as $,f as i,h as Z,m as _,g as ee,n as me,l as le,w as ce,q as fe}from"./app-CbT4YxG1.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ye={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},xe={class:"bg-gradient-to-br from-orange-200 to-red-400 dark:bg-gray-900 rounded-lg shadow-lg max-w-5xl w-full p-6 overflow-auto max-h-[90vh] relative",style:{"min-width":"700px"}},ke={key:0},we={key:1,class:"text-red-600 dark:text-red-400"},he={class:"grid grid-cols-2 gap-8"},Ce={class:"mt-6"},Fe={class:"mt-4"},Ie=["value"],Me={class:"mt-4"},Re=["value","disabled"],Se={class:"grid grid-cols-3 gap-2"},Ne={class:"image-wrapper"},$e=["src"],Ee={key:1,class:"placeholder"},Ue={class:"image-wrapper"},Ae=["src"],Pe={key:1,class:"placeholder"},De={class:"image-wrapper"},Ge=["src"],je={key:1,class:"placeholder"},Be={class:"image-wrapper"},Te=["src"],Ve={key:1,class:"placeholder"},ze={class:"image-wrapper"},Oe=["src"],Le={key:1,class:"placeholder"},Ye={class:"image-wrapper"},He=["src"],qe={key:1,class:"placeholder"},Je={class:"image-wrapper"},Ke=["src"],Qe={key:1,class:"placeholder"},We={class:"image-wrapper"},Xe=["src"],Ze={key:1,class:"placeholder"},_e={class:"image-wrapper"},el=["src"],ll={key:1,class:"placeholder"},ol={class:"image-wrapper"},tl=["src"],sl={key:1,class:"placeholder"},nl={class:"flex justify-end space-x-4 mt-6"},al=["disabled"],dl={key:0,class:"text-sm text-gray-600 mt-2"},rl={key:3},il={class:"relative max-w-[90vw] max-h-[90vh]"},ul=["src"],pl={key:0,class:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-4 py-2 rounded shadow-lg z-50"},gl={__name:"ApplicationReviewModal",props:{show:Boolean,userEmail:String},emits:["close","reupload"],setup(oe,{emit:te}){const h=window.axios,se=oe,ne=te;ie(()=>se.show,async a=>{a&&await S()});const f=d(""),C=d(""),F=d(!1),E=d(!1),I=d(""),t=d(null),b=d({visible:!1,message:""}),M=(a,e=3e3)=>{b.value.message=a,b.value.visible=!0,setTimeout(()=>{b.value.visible=!1},e)},R=ue(()=>{var e;const a=(e=t.value)==null?void 0:e.status;return!a||["draft","returned"].includes(a)}),S=async()=>{var a;E.value=!0,I.value="";try{const e=await h.get("/user/application");t.value=e.data,console.log("Application status:",(a=t.value)==null?void 0:a.status),await re(),console.log("Setting selected:",e.data.program_id),pe(()=>{f.value=e.data.program_id??"",C.value=e.data.second_choice_id??""})}catch{I.value="Failed to load application data."}finally{E.value=!1}},D=()=>{F.value=!0,S()},U=()=>{F.value=!1},ae=async()=>{try{await h.post("/user/application/submit",{program_id:f.value,second_choice_id:C.value||null}),await S(),ne("refreshDashboard"),M("Application submitted!"),setTimeout(()=>{U()},1e3)}catch{M("Failed to submit application. Choose programs before submitting.")}};ge(()=>{D(),de.value={file10Front:null,file11:null,file12:null,schoolId:null,nonEnrollCert:null,psa:null,goodMoral:null,underOath:null,photo2x2:null}});const N=d(null),A=d(!1),u=a=>{const e=typeof a=="string"?a:a==null?void 0:a.url;if(console.log("openImageModal called with:",a),console.log("Extracted URL:",e),!e){console.warn("No valid URL found");return}N.value=e,A.value=!0},G=()=>{A.value=!1,N.value=null},de=d({}),j=d(null),B=d(null),T=d(null),V=d(null),z=d(null),O=d(null),L=d(null),Y=d(null),H=d(null),q=d(null),p=a=>{const v={file10Front:j,file:B,file11:T,file12:V,schoolId:z,nonEnrollCert:O,psa:L,goodMoral:Y,underOath:H,photo2x2:q}[a];v&&v.value&&v.value.click()},g=async(a,e)=>{var y,x,k;const v=a.target.files[0];if(!v)return;const c=new FormData;c.append("file",v),c.append("field",e);try{const m=await h.post("/user/application/reupload",c,{headers:{"Content-Type":"multipart/form-data"}});M("File reuploaded!"),await S()}catch(m){console.error("Reupload error:",((y=m.response)==null?void 0:y.data)||m),M(((k=(x=m.response)==null?void 0:x.data)==null?void 0:k.message)||"Failed to reupload file.")}},P=d([]),re=async()=>{try{const a=await h.get("/user/eligible-programs");P.value=a.data.programs}catch{console.error("Failed to load eligible programs")}};return(a,e)=>{var v,c,y,x,k,m,J,K,Q,W,X;return n(),s($,null,[F.value?(n(),s("div",ye,[l("div",xe,[l("button",{onClick:U,class:"absolute top-3 right-3 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white text-3xl font-bold","aria-label":"Close modal"}," × "),E.value?(n(),s("p",ke,"Loading application data...")):I.value?(n(),s("p",we,r(I.value),1)):t.value?(n(),s($,{key:2},[e[65]||(e[65]=l("h2",{class:"text-xl font-bold mb-4 text-gray-900 dark:text-white"}," Review Your Application ",-1)),l("div",he,[l("div",null,[l("section",null,[e[40]||(e[40]=l("h3",{class:"font-semibold mb-2 text-gray-800 dark:text-gray-300"}," Personal Details ",-1)),l("p",null,[e[34]||(e[34]=l("strong",null,"Name:",-1)),i(" "+r(t.value.firstname)+" "+r(t.value.middlename)+" "+r(t.value.lastname),1)]),l("p",null,[e[35]||(e[35]=l("strong",null,"Birthday:",-1)),i(" "+r(t.value.birthday),1)]),l("p",null,[e[36]||(e[36]=l("strong",null,"Sex/Gender:",-1)),i(" "+r(t.value.sex),1)]),l("p",null,[e[37]||(e[37]=l("strong",null,"Contact Number:",-1)),i(" +63"+r(t.value.contactnumber),1)]),l("p",null,[e[38]||(e[38]=l("strong",null,"Address:",-1)),i(" "+r(t.value.address),1)]),l("p",null,[e[39]||(e[39]=l("strong",null,"Email:",-1)),i(" "+r(t.value.email),1)])]),l("section",Ce,[e[47]||(e[47]=l("h3",{class:"font-semibold mb-2 text-gray-800 dark:text-gray-300"}," High School Details ",-1)),l("p",null,[e[41]||(e[41]=l("strong",null,"School:",-1)),i(" "+r(t.value.school),1)]),l("p",null,[e[42]||(e[42]=l("strong",null,"School Address:",-1)),i(" "+r(t.value.schoolAdd),1)]),l("p",null,[e[43]||(e[43]=l("strong",null,"School Year:",-1)),i(" "+r(t.value.schoolyear),1)]),l("p",null,[e[44]||(e[44]=l("strong",null,"Date Graduated:",-1)),i(" "+r(t.value.dateGrad),1)]),l("p",null,[e[45]||(e[45]=l("strong",null,"Strand:",-1)),i(" "+r(t.value.strand),1)]),l("p",null,[e[46]||(e[46]=l("strong",null,"Track:",-1)),i(" "+r(t.value.track),1)])]),l("div",Fe,[e[49]||(e[49]=l("label",{for:"programSelect",class:"block text-sm font-medium text-gray-700"}," Choose Your Program ",-1)),Z(l("select",{id:"programSelect","onUpdate:modelValue":e[0]||(e[0]=o=>f.value=o),class:"mt-1 block w-full rounded border-gray-300 shadow-sm"},[e[48]||(e[48]=l("option",{value:""},"-- Select Program --",-1)),(n(!0),s($,null,ee(P.value,o=>(n(),s("option",{key:o.id,value:o.id},r(o.name)+" ("+r(o.code)+") ",9,Ie))),128))],512),[[_,f.value]])]),l("div",Me,[e[51]||(e[51]=l("label",{for:"secondProgramSelect",class:"block text-sm font-medium text-gray-700"}," Choose Your Second Program ",-1)),Z(l("select",{id:"secondProgramSelect","onUpdate:modelValue":e[1]||(e[1]=o=>C.value=o),class:"mt-1 block w-full rounded border-gray-300 shadow-sm"},[e[50]||(e[50]=l("option",{value:""},"-- Select Program --",-1)),(n(!0),s($,null,ee(P.value,o=>(n(),s("option",{key:o.id,value:o.id,disabled:o.id===f.value},r(o.name)+" ("+r(o.code)+") ",9,Re))),128))],512),[[_,C.value]])])]),l("section",null,[e[62]||(e[62]=l("h3",{class:"font-semibold mb-2 text-gray-800 dark:text-gray-300"}," Uploaded Documents ",-1)),l("div",Se,[l("div",Ne,[e[52]||(e[52]=l("p",null,"Grade 10 Front:",-1)),t.value.uploadedFiles.file10Front?(n(),s("img",{key:0,src:(v=t.value.uploadedFiles.file10Front)==null?void 0:v.url,alt:"Grade 10 Front",class:"max-h-20 object-contain border rounded",onClick:e[2]||(e[2]=o=>u(t.value.uploadedFiles.file10Front))},null,8,$e)):(n(),s("div",Ee," No Image Uploaded ")),l("input",{type:"file",ref_key:"file10FrontInput",ref:j,style:{display:"none"},accept:"image/*,.pdf",onChange:e[3]||(e[3]=o=>g(o,"file10Front"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[4]||(e[4]=o=>p("file10Front"))}," Reupload ")]),l("div",Ue,[e[53]||(e[53]=l("p",null,"Grade 10 Back:",-1)),t.value.uploadedFiles.file10_back?(n(),s("img",{key:0,src:(c=t.value.uploadedFiles.file10_back)==null?void 0:c.url,alt:"Grade 10 Front",class:"max-h-20 object-contain border rounded",onClick:e[5]||(e[5]=o=>u(t.value.uploadedFiles.file10_back))},null,8,Ae)):(n(),s("div",Pe," No Image Uploaded ")),l("input",{type:"file",ref_key:"fileInput",ref:B,style:{display:"none"},accept:"image/*,.pdf",onChange:e[6]||(e[6]=o=>g(o,"file"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[7]||(e[7]=o=>p("file"))}," Reupload ")]),l("div",De,[e[54]||(e[54]=l("p",null,"Grade 11 Report:",-1)),t.value.uploadedFiles.file11?(n(),s("img",{key:0,src:(y=t.value.uploadedFiles.file11)==null?void 0:y.url,alt:"Grade 11 Report",class:"max-h-20 object-contain border rounded",onClick:e[8]||(e[8]=o=>u(t.value.uploadedFiles.file11))},null,8,Ge)):(n(),s("div",je," No Image Uploaded ")),l("input",{type:"file",ref_key:"file11Input",ref:T,style:{display:"none"},accept:"image/*,.pdf",onChange:e[9]||(e[9]=o=>g(o,"file11"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[10]||(e[10]=o=>p("file11"))}," Reupload ")]),l("div",Be,[e[55]||(e[55]=l("p",null,"Grade 12 Report:",-1)),t.value.uploadedFiles.file12?(n(),s("img",{key:0,src:(x=t.value.uploadedFiles.file12)==null?void 0:x.url,alt:"Grade 12 Report",class:"max-h-20 object-contain border rounded",onClick:e[11]||(e[11]=o=>u(t.value.uploadedFiles.file12))},null,8,Te)):(n(),s("div",Ve," No Image Uploaded ")),l("input",{type:"file",ref_key:"file12Input",ref:V,style:{display:"none"},accept:"image/*,.pdf",onChange:e[12]||(e[12]=o=>g(o,"file12"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[13]||(e[13]=o=>p("file12"))}," Reupload ")]),l("div",ze,[e[56]||(e[56]=l("p",null,"School ID:",-1)),t.value.uploadedFiles.schoolId?(n(),s("img",{key:0,src:(k=t.value.uploadedFiles.schoolId)==null?void 0:k.url,alt:"School ID",class:"max-h-20 object-contain border rounded",onClick:e[14]||(e[14]=o=>u(t.value.uploadedFiles.schoolId))},null,8,Oe)):(n(),s("div",Le," No Image Uploaded ")),l("input",{type:"file",ref_key:"schoolIdInput",ref:z,style:{display:"none"},accept:"image/*,.pdf",onChange:e[15]||(e[15]=o=>g(o,"schoolId"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[16]||(e[16]=o=>p("schoolId"))}," Reupload ")]),l("div",Ye,[e[57]||(e[57]=l("p",null,"Certificate of Non-Enrollment:",-1)),t.value.uploadedFiles.nonEnrollCert?(n(),s("img",{key:0,src:(m=t.value.uploadedFiles.nonEnrollCert)==null?void 0:m.url,alt:"Non-Enrollment Certificate",class:"max-h-20 object-contain border rounded",onClick:e[17]||(e[17]=o=>u(t.value.uploadedFiles.nonEnrollCert))},null,8,He)):(n(),s("div",qe," No Image Uploaded ")),l("input",{type:"file",ref_key:"nonEnrollCertInput",ref:O,style:{display:"none"},accept:"image/*,.pdf",onChange:e[18]||(e[18]=o=>g(o,"nonEnrollCert"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[19]||(e[19]=o=>p("nonEnrollCert"))}," Reupload ")]),l("div",Je,[e[58]||(e[58]=l("p",null,"PSA Birth Certificate:",-1)),t.value.uploadedFiles.psa?(n(),s("img",{key:0,src:(J=t.value.uploadedFiles.psa)==null?void 0:J.url,alt:"PSA",class:"max-h-20 object-contain border rounded",onClick:e[20]||(e[20]=o=>u(t.value.uploadedFiles.psa))},null,8,Ke)):(n(),s("div",Qe," No Image Uploaded ")),l("input",{type:"file",ref_key:"psaInput",ref:L,style:{display:"none"},accept:"image/*,.pdf",onChange:e[21]||(e[21]=o=>g(o,"psa"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[22]||(e[22]=o=>p("psa"))}," Reupload ")]),l("div",We,[e[59]||(e[59]=l("p",null,"Good Moral Certificate:",-1)),t.value.uploadedFiles.goodMoral?(n(),s("img",{key:0,src:(K=t.value.uploadedFiles.goodMoral)==null?void 0:K.url,alt:"Good Moral",class:"max-h-20 object-contain border rounded",onClick:e[23]||(e[23]=o=>u(t.value.uploadedFiles.goodMoral))},null,8,Xe)):(n(),s("div",Ze," No Image Uploaded ")),l("input",{type:"file",ref_key:"goodMoralInput",ref:Y,style:{display:"none"},accept:"image/*,.pdf",onChange:e[24]||(e[24]=o=>g(o,"goodMoral"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[25]||(e[25]=o=>p("goodMoral"))}," Reupload ")]),l("div",_e,[e[60]||(e[60]=l("p",null,"Under Oath Document:",-1)),t.value.uploadedFiles.underOath?(n(),s("img",{key:0,src:(Q=t.value.uploadedFiles.underOath)==null?void 0:Q.url,alt:"Under Oath",class:"max-h-20 object-contain border rounded",onClick:e[26]||(e[26]=o=>u(t.value.uploadedFiles.underOath))},null,8,el)):(n(),s("div",ll," No Image Uploaded ")),l("input",{type:"file",ref_key:"underOathInput",ref:H,style:{display:"none"},accept:"image/*,.pdf",onChange:e[27]||(e[27]=o=>g(o,"underOath"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[28]||(e[28]=o=>p("underOath"))}," Reupload ")]),l("div",ol,[e[61]||(e[61]=l("p",null,"2x2 Photo:",-1)),t.value.uploadedFiles.photo2x2?(n(),s("img",{key:0,src:(W=t.value.uploadedFiles.photo2x2)==null?void 0:W.url,alt:"2x2 Photo",class:"max-h-20 object-contain border rounded",onClick:e[29]||(e[29]=o=>u(t.value.uploadedFiles.photo2x2))},null,8,tl)):(n(),s("div",sl," No Image Uploaded ")),l("input",{type:"file",ref_key:"photo2x2Input",ref:q,style:{display:"none"},accept:"image/*,.pdf",onChange:e[30]||(e[30]=o=>g(o,"photo2x2"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[31]||(e[31]=o=>p("photo2x2"))}," Reupload ")])])])]),l("div",nl,[l("button",{onClick:U,class:"px-4 py-2 bg-gray-400 rounded hover:bg-gray-500 text-gray-800"}," Cancel "),l("button",{disabled:!R.value,onClick:ae,class:me(["px-4 py-2 rounded text-white",{"bg-gray-400 cursor-not-allowed":!R.value,"bg-maroon-700 hover:bg-maroon-900":R.value}])}," Submit Application ",10,al),(X=t.value)!=null&&X.status&&!R.value?(n(),s("p",dl,[e[63]||(e[63]=i(" Application already ")),l("strong",null,r(t.value.status),1),e[64]||(e[64]=i(". "))])):w("",!0)])],64)):(n(),s("p",rl,"No application data found."))])])):w("",!0),F.value?w("",!0):(n(),s("button",{key:1,onClick:D,"aria-label":"Open Application Modal",class:"fixed bottom-8 right-8 bg-maroon-700 hover:bg-maroon-900 text-white p-8 rounded-full shadow-lg focus:outline-none",title:"Review Application"},e[66]||(e[66]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]))),A.value?(n(),s("div",{key:2,class:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[60]",onClick:G},[l("div",il,[l("img",{src:N.value,alt:"Preview",class:"max-w-full max-h-[90vh] object-contain rounded shadow-lg",onClick:e[32]||(e[32]=le(()=>{},["stop"])),onError:e[33]||(e[33]=o=>console.error("Image failed to load:",N.value))},null,40,ul)]),l("button",{onClick:le(G,["stop"]),class:"absolute top-5 right-5 text-white text-4xl font-bold hover:text-gray-300","aria-label":"Close preview"}," × ")])):w("",!0),ve(fe,{name:"fade"},{default:ce(()=>[b.value.visible?(n(),s("div",pl,r(b.value.message),1)):w("",!0)]),_:1})],64)}}},cl=be(gl,[["__scopeId","data-v-4f0c4f13"]]);export{cl as default};
