import{r as c,j as ee,m as E,p as te,d as r,o as n,b as A,u as se,Z as oe,w as q,a as t,e as f,h as H,v as le,t as l,F as k,g as M,n as K,q as ae,s as re,f as ne,k as ie}from"./app-BtBKtxEV.js";import{A as de}from"./AppLayout-DJ_iHzkd.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-4svGZ16I.js";const ce={class:"max-w-7xl mx-auto py-2 px-2 sm:px-4 md:px-6 lg:px-8 overflow-x-hidden overflow-y-auto"},pe={class:"flex flex-col md:flex-row justify-between md:items-center mb-2 gap-2"},me={class:"flex flex-wrap justify-end gap-2 items-center w-full md:w-auto"},ve={class:"flex items-center border-4 border-red-400 rounded-full px-2 py-1.5 bg-white w-full sm:w-auto"},xe={class:"relative"},ge={key:0,class:"absolute top-full mt-2 right-0 bg-white shadow-md border border-gray-200 rounded z-50 text-sm"},fe={xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},be=["d"],he={class:"bg-white/20 rounded-xl shadow p-2 overflow-x-auto"},we={class:"text-sm text-[#4B5563] mb-2"},ye={class:"min-w-full text-base"},ke={class:"text-left text-white font-semibold"},Ce={class:"divide-y divide-gray-600"},_e=["onClick"],Ee={class:"py-2 text-[#111827] font-medium"},Ae={class:"py-2 text-[#111827]"},Me={class:"py-2"},Ue={class:"flex justify-end items-center space-x-4 mt-4"},je=["disabled"],Se={class:"text-sm"},Fe=["disabled"],$e={key:0,class:"text-center text-gray-400 mt-4"},Ne={key:0,class:"fixed top-0 right-0 w-full md:w-1/3 h-full bg-white dark:bg-gray-900 p-6 z-50 shadow-xl shadow-red-200 transition duration-300 ease-in-out overflow-y-auto"},Ie={class:"text-gray-800 dark:text-gray-200 font-medium"},Le={class:"text-gray-700 dark:text-gray-400"},Pe={class:"text-sm text-gray-700 dark:text-gray-300"},Ve={class:"text-sm text-gray-700 dark:text-gray-300"},De={class:"text-sm text-gray-700 dark:text-gray-300"},Be={class:"mt-3 p-2 border rounded bg-gray-100 dark:bg-gray-800"},ze={class:"text-sm text-gray-800 dark:text-gray-300"},Re={class:"mt-3 text-sm"},Ge={class:"grid grid-cols-3 gap-2"},Te={class:"flex items-center space-x-2 w-full"},qe=["id","onUpdate:modelValue"],He=["for"],Ke={class:"w-full"},Oe=["src","onClick"],Xe={key:1,class:"h-16 flex items-center justify-center text-[10px] italic text-gray-400 border rounded"},Qe={key:0,class:"mt-4"},We={class:"border-l-2 border-red-400 pl-3 space-y-2"},Ze={class:"text-sm font-semibold text-gray-900 dark:text-white"},Je={key:0,class:"text-xs text-gray-500 italic"},Ye={class:"text-xs text-gray-400"},et=["src"],U=10,tt={__name:"Applications",setup(st){const j=c([]),h=c(""),p=c(""),a=c(null),m=c(1),b=c("lastname"),u=c(!0),v=c(!1),y=c({});ee(async()=>{try{const s=await fetch("/dashboard/users",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error("Failed to fetch users");j.value=await s.json()}catch(s){console.error(s)}});const C=E(()=>{const s=h.value.trim().toLowerCase();return j.value.filter(e=>{var w;const i=`${e.firstname} ${e.lastname}`.toLowerCase().includes(s),g=p.value?((w=e.status)==null?void 0:w.toLowerCase())===p.value:!0;return i&&g}).sort((e,o)=>{const i=(e[b.value]||"").toString().toLowerCase(),g=(o[b.value]||"").toString().toLowerCase();return u.value?i.localeCompare(g):g.localeCompare(i)})}),S=E(()=>Math.ceil(C.value.length/U)),_=E(()=>{const s=(m.value-1)*U;return C.value.slice(s,s+U)});te([h,p,b,u],()=>{m.value=1});const O=s=>{const e=(s||"").toLowerCase();return e==="accepted"?"bg-green-100 text-green-700":e==="pending"?"bg-yellow-100 text-yellow-700":e==="rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"},X=async s=>{var e,o;try{const i=await axios.get(`/admin-dashboard/user-files/${s.id}`);a.value={...s,application:{...i.data.user.application,processes:((e=i.data.user.application)==null?void 0:e.processes)||[]},grades:i.data.user.grades||null},y.value=i.data.uploadedFiles||{},console.log("User & files:",a.value,y.value),console.log("processes:",a.processes),console.log("Processes:",(o=a.value.application)==null?void 0:o.processes)}catch(i){console.error("Failed to fetch user data:",i),y.value={},a.value=null}},Q=s=>({file10Front:"Grade 10 Front",file11:"Grade 11 Report",file12:"Grade 12 Report",schoolId:"School ID",nonEnrollCert:"Certificate of Non-Enrollment",psa:"PSA Birth Certificate",goodMoral:"Good Moral Certificate",underOath:"Under Oath Document",photo2x2:"2x2 Photo"})[s]||s,F=s=>typeof s=="string"?s.charAt(0).toUpperCase()+s.slice(1):"",W=s=>new Date(s).toLocaleString(),Z=()=>{a.value=null},J=s=>{b.value===s?u.value=!u.value:(b.value=s,u.value=!0)},Y=()=>{h.value="",p.value="",b.value="lastname",u.value=!0,m.value=1,v.value=!1};return(s,e)=>(n(),r(k,null,[A(se(oe),{title:"All Applications"}),A(de,null,{default:q(()=>[t("div",ce,[t("div",pe,[e[14]||(e[14]=t("h2",{class:"text-2xl font-bold text-[#9E122C]"}," All Applications ",-1)),t("div",me,[t("div",ve,[e[12]||(e[12]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-[#9E122C] mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),H(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>h.value=o),type:"text",placeholder:"Search by name...",class:"bg-transparent border-none outline-none focus:ring-0 focus:outline-none text-sm text-[#9E122C] placeholder-gray-500 w-full"},null,512),[[le,h.value]])]),t("button",{onClick:Y,class:"text-sm text-[#9E122C] border border-[#9E122C] rounded px-3 py-1.5 hover:bg-[#FDE8EA] transition"}," Clear Filters "),t("div",xe,[t("button",{onClick:e[1]||(e[1]=o=>v.value=!v.value),class:"text-[#9E122C] p-2 border border-[#9E122C] rounded-full",title:"Filter"},e[13]||(e[13]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2a1 1 0 01-.293.707L15 12.414V19a1 1 0 01-1.447.894l-4-2A1 1 0 019 17v-4.586L3.293 6.707A1 1 0 013 6V4z"})],-1)])),v.value?(n(),r("div",ge,[t("button",{class:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:e[2]||(e[2]=o=>{p.value="",v.value=!1})}," All "),t("button",{class:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:e[3]||(e[3]=o=>{p.value="accepted",v.value=!1})}," Accepted "),t("button",{class:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:e[4]||(e[4]=o=>{p.value="pending",v.value=!1})}," Pending "),t("button",{class:"block px-4 py-2 w-full text-left hover:bg-gray-100",onClick:e[5]||(e[5]=o=>{p.value="rejected",v.value=!1})}," Rejected ")])):f("",!0)]),t("button",{onClick:e[6]||(e[6]=o=>u.value=!u.value),class:"text-[#9E122C] p-2 border border-[#9E122C] rounded-full",title:"Sort"},[(n(),r("svg",fe,[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:u.value?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"},null,8,be)]))])])]),t("div",he,[t("div",we," Showing "+l(_.value.length)+" of "+l(C.value.length)+" users ",1),t("table",ye,[t("thead",null,[t("tr",ke,[t("th",{class:"pb-2 cursor-pointer",onClick:e[7]||(e[7]=o=>J("lastname"))}," Name "),e[15]||(e[15]=t("th",{class:"pb-2"},"Course",-1)),e[16]||(e[16]=t("th",{class:"pb-2"},"Status",-1))])]),t("tbody",Ce,[(n(!0),r(k,null,M(_.value,o=>(n(),r("tr",{key:o.id,onClick:i=>X(o),class:"cursor-pointer hover:bg-white/10 backdrop-blur-sm transition"},[t("td",Ee,l(o.firstname)+" "+l(o.lastname),1),t("td",Ae,l(o.program.name||"—"),1),t("td",Me,[t("span",{class:K([O(o.status),"px-2 py-1 rounded text-sm font-semibold"])},l(o.status||"Unknown"),3)])],8,_e))),128))])]),t("div",Ue,[t("button",{onClick:e[8]||(e[8]=o=>m.value--),disabled:m.value===1,class:"text-sm text-[#9E122C] disabled:text-gray-900"}," Previous ",8,je),t("span",Se,"Page "+l(m.value)+" of "+l(S.value),1),t("button",{onClick:e[9]||(e[9]=o=>m.value++),disabled:m.value===S.value,class:"text-sm text-[#9E122C] disabled:text-gray-900"}," Next ",8,Fe)]),_.value.length===0?(n(),r("p",$e," No results found. ")):f("",!0)])]),A(ae,{name:"slide-fade"},{default:q(()=>{var o,i,g,w,$,N,I,L,P,V,D,B,z,R,G;return[a.value?(n(),r("div",Ne,[t("button",{class:"mt-6 px-4 py-2 rounded bg-[#9E122C] text-white hover:bg-[#EE6A43] transition",onClick:Z}," Close "),e[21]||(e[21]=t("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," User Information ",-1)),t("p",Ie," Name: "+l(a.value.lastname)+", "+l(a.value.firstname),1),t("p",Le," Email: "+l(a.value.email),1),e[22]||(e[22]=t("h4",{class:"text-sm font-bold text-gray-700 dark:text-white mb-1"}," Grades ",-1)),t("p",Pe," Math: "+l(((i=(o=a.value)==null?void 0:o.grades)==null?void 0:i.mathematics)??"—"),1),t("p",Ve," Science: "+l(((w=(g=a.value)==null?void 0:g.grades)==null?void 0:w.science)??"—"),1),t("p",De," English: "+l(((N=($=a.value)==null?void 0:$.grades)==null?void 0:N.english)??"—"),1),t("div",Be,[e[17]||(e[17]=t("h4",{class:"text-sm font-bold text-gray-700 dark:text-white mb-1"}," Current Program for Acceptance: ",-1)),t("p",ze,l((P=(L=(I=a.value)==null?void 0:I.application)==null?void 0:L.program)==null?void 0:P.code)+" - "+l((B=(D=(V=a.value)==null?void 0:V.application)==null?void 0:D.program)==null?void 0:B.name),1)]),t("section",Re,[e[20]||(e[20]=t("h4",{class:"font-semibold mb-1 text-base"}," Uploaded Documents ",-1)),t("div",Ge,[(n(!0),r(k,null,M(y.value,(d,x)=>(n(),r("div",{key:x,class:"flex flex-col items-start space-y-1"},[t("div",Te,[s.isEvaluating?H((n(),r("input",{key:0,type:"checkbox",id:x,"onUpdate:modelValue":T=>s.filesToReturn[x]=T,class:"h-4 w-4 mt-1"},null,8,qe)),[[re,s.filesToReturn[x]]]):f("",!0),t("label",{for:x,class:"text-xs font-medium truncate w-full"},l(Q(x)),9,He)]),t("div",Ke,[d?(n(),r("img",{key:0,src:d,alt:"Uploaded Document",class:"h-16 w-full object-contain border rounded cursor-pointer",onClick:T=>s.openImageModal(d)},null,8,Oe)):(n(),r("div",Xe," No Image "))])]))),128))]),(G=(R=(z=a.value)==null?void 0:z.application)==null?void 0:R.processes)!=null&&G.length?(n(),r("section",Qe,[e[19]||(e[19]=t("h4",{class:"font-semibold mb-2 text-base text-gray-800 dark:text-gray-200"}," Application History ",-1)),t("ul",We,[(n(!0),r(k,null,M(a.value.application.processes,(d,x)=>(n(),r("li",{key:x,class:"relative"},[e[18]||(e[18]=t("div",{class:"absolute -left-[10px] top-1 w-3 h-3 bg-red-600 rounded-full border-2 border-white"},null,-1)),t("p",Ze,[ne(l(F(d.stage))+" - ",1),t("span",{class:K({"text-green-600":d.status==="completed","text-yellow-600":d.status==="in_progress","text-red-600":d.status==="returned"})},l(F(d.status)),3)]),d.notes?(n(),r("p",Je," Note: "+l(d.notes),1)):f("",!0),t("p",Ye,l(W(d.created_at)),1)]))),128))])])):f("",!0)])])):f("",!0)]}),_:1}),s.showImageModal?(n(),r("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",onClick:e[11]||(e[11]=ie((...o)=>s.closeImageModal&&s.closeImageModal(...o),["self"]))},[t("img",{src:s.previewImage,alt:"Preview",class:"max-w-full max-h-full rounded shadow-lg"},null,8,et),t("button",{onClick:e[10]||(e[10]=(...o)=>s.closeImageModal&&s.closeImageModal(...o)),class:"absolute top-5 right-5 text-white text-4xl font-bold hover:text-gray-300","aria-label":"Close preview"}," × ")])):f("",!0)]),_:1})],64))}},it=ue(tt,[["__scopeId","data-v-0bd758e7"]]);export{it as default};
