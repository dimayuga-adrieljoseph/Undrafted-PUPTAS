import{r as n,i as T,p as V,c as z,o as l,w as M,a as t,d as o,e as x,b as K,n as w,t as r,F as S,g as j,f as Y,l as Z}from"./app-CbT4YxG1.js";import{_ as q}from"./ApplicantLayout-OouB3jvv.js";import G from"./ApplicationReviewModal-ByJFEHjU.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Sidebar-ynefkf4f.js";import"./index-D26V7tGX.js";import"./useGlobalLoading-haryylb7.js";const J={class:"py-12 overflow-y-auto scrollbar-hide"},Q={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},W={class:"bg-white/25 dark:bg-gray-800 shadow-xl sm:rounded-lg p-6"},X={key:0,class:"mb-6"},ee={key:1,class:"overflow-x-auto scrollbar-hide mb-8"},te={class:"relative inline-block min-w-full py-4"},se={class:"flex justify-between items-center relative"},ae={class:"mt-2 text-xs text-center text-gray-700 dark:text-gray-300"},le={class:"text-xs text-center text-gray-500 dark:text-gray-400"},oe={class:"text-xs text-center text-gray-500 dark:text-gray-400"},re={class:"text-xs text-center text-gray-500 dark:text-gray-400"},ne={key:0},ie={key:1},ce={key:2,class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6 mb-8"},de={class:"text-xs text-center text-gray-700 dark:text-gray-300"},ue=["src","onClick"],pe=["onClick"],xe=["onChange"],ge={key:3,class:"text-center py-6"},ve={key:4,class:"text-center py-6 text-gray-500"},fe={key:5,class:"text-red-500"},me=["src"],ye={__name:"ApplicantDashboard",props:{user:Object},setup(F){const k=window.axios,B=F,f=n(!1),d=n(!1),g=n(""),c=n({}),v=n(""),m=n([]),C=n({}),y=T(()=>Object.keys(c.value)),N=e=>e.replace(/([A-Z])/g," $1").toUpperCase(),R=e=>e.charAt(0).toUpperCase()+e.slice(1).replace("_"," "),L=e=>e.charAt(0).toUpperCase()+e.slice(1),P=e=>e?new Date(e).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",h=e=>{switch((e||"").toLowerCase()){case"draft":return"bg-gray-400 border-gray-400";case"submitted":return"bg-blue-500 border-blue-500";case"in_progress":return"bg-yellow-500 border-yellow-500";case"completed":return"bg-green-500 border-green-500";case"returned":return"bg-red-500 border-red-500";default:return"bg-gray-500 border-gray-500"}};async function A(){d.value=!0,g.value="";try{const{data:e}=await k.get("/user/application");c.value=e.uploadedFiles||{},v.value=e.status||"",m.value=e.processes||[]}catch{g.value="Could not load application data."}finally{d.value=!1}}const U=e=>{var a;return(a=C.value[e])==null?void 0:a.click()},$=async(e,a)=>{const s=e.target.files[0];if(!s)return;d.value=!0;const i=new FormData;i.append("file",s),i.append("field",a);try{const{data:u}=await k.post("/user/application/reupload",i);c.value[a]={url:u.url,status:u.status}}catch{alert("Failed to reupload file.")}finally{d.value=!1}},_=n(!1),b=n(""),E=e=>{e&&(b.value=e,_.value=!0)},D=()=>{_.value=!1,b.value=""},O=()=>f.value=!1;return V(()=>{A(),f.value=!0}),(e,a)=>(l(),z(q,{title:"Applicant Dashboard"},{header:M(()=>a[0]||(a[0]=[t("h2",{class:"font-semibold text-xl text-gray-900 dark:text-gray-200 leading-tight"}," Applicant Dashboard ",-1)])),default:M(()=>[t("div",J,[t("div",Q,[t("div",W,[a[5]||(a[5]=t("h1",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," YOUR APPLICATION TRACKER ",-1)),v.value?(l(),o("div",X,[a[1]||(a[1]=t("span",{class:"font-semibold"},"Current Status:",-1)),t("span",{class:w(`ml-2 px-3 py-1 rounded-full text-white ${h(v.value)}`)},r(L(v.value)),3)])):x("",!0),m.value.length?(l(),o("div",ee,[t("div",te,[a[3]||(a[3]=t("div",{class:"absolute inset-x-0 top-6 h-px bg-gray-300 dark:bg-gray-600"},null,-1)),t("div",se,[(l(!0),o(S,null,j(m.value,(s,i)=>(l(),o("div",{key:i,class:"flex flex-col items-center px-2"},[t("div",{class:w(["w-6 h-6 rounded-full border-2 flex items-center justify-center text-white text-xs",h(s.status)])},r(i+1),3),t("div",ae,r(R(s.stage)),1),t("div",le,r(P(s.created_at)),1),t("div",oe,r(s.notes),1),t("div",re,[a[2]||(a[2]=Y(" By: ")),s.performed_by?(l(),o("span",ne,r(s.performed_by.firstname)+" "+r(s.performed_by.lastname),1)):(l(),o("span",ie,"System"))])]))),128))])])])):x("",!0),y.value.length?(l(),o("div",ce,[(l(!0),o(S,null,j(y.value,(s,i)=>{var u,I;return l(),o("div",{key:s,class:"flex flex-col items-center space-y-2"},[t("div",{class:w(["w-6 h-6 rounded-full flex items-center justify-center text-white text-xs",h((u=c.value[s])==null?void 0:u.status)])},r(i+1),3),t("div",de,r(N(s)),1),t("div",null,[(I=c.value[s])!=null&&I.url?(l(),o("img",{key:0,src:c.value[s].url,alt:"Preview",class:"w-12 h-12 object-cover rounded cursor-pointer border",onClick:p=>E(c.value[s].url)},null,8,ue)):(l(),o("button",{key:1,onClick:p=>U(s),class:"text-blue-600 text-xs"}," Upload ",8,pe)),t("input",{type:"file",ref_for:!0,ref:p=>C.value[s]=p,class:"hidden",onChange:p=>$(p,s)},null,40,xe)])])}),128))])):x("",!0),d.value?(l(),o("div",ge,a[4]||(a[4]=[t("span",{class:"animate-pulse text-gray-600 dark:text-gray-300"}," Loading… ",-1)]))):y.value.length?g.value?(l(),o("div",fe,r(g.value),1)):x("",!0):(l(),o("div",ve," No files to display. "))]),K(G,{show:f.value,userEmail:B.user.email,onClose:O,onRefreshDashboard:A},null,8,["show","userEmail"])])]),_.value?(l(),o("div",{key:0,class:"fixed inset-0 z-50 bg-black bg-opacity-80 flex items-center justify-center",onClick:D},[t("img",{src:b.value,alt:"Preview",class:"max-w-[90vw] max-h-[90vh] rounded shadow"},null,8,me),t("button",{class:"absolute top-5 right-5 text-white text-3xl font-bold","aria-label":"Close preview",onClick:Z(D,["stop"])}," × ")])):x("",!0)]),_:1}))}},De=H(ye,[["__scopeId","data-v-cc484640"]]);export{De as default};
