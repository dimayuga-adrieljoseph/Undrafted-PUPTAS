import{Q as me,r as d,p as fe,i as J,d as o,o as r,b,u as h,Z as ge,w as k,a as e,t as a,e as u,k as be,f as U,F as C,g as A,n as Q,q as X,h as K,v as ve,s as he,l as ye}from"./app-BScDaa5r.js";import{L as we}from"./index-BmiYyJBB.js";import{_ as _e}from"./MedicalLayout-D2_67H6U.js";import{C as ke,L as Ce,a as Me,b as je,c as Ee,P as Fe,p as Ue,d as Ae,e as Le}from"./chart-B9tDx7Vv.js";import{F as Be,c as Ne}from"./index-Z-NJ8KKZ.js";import{_ as Re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Sidebar-BCBaA1aj.js";import"./useGlobalLoading-BL86BHNh.js";const De={class:"flex flex-wrap justify-center gap-[6rem] px-4 py-4 max-w-full overflow-hidden"},Se={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Ie={class:"text-3xl font-bold text-gray-900"},Pe={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Ve={class:"text-3xl font-bold text-gray-900"},Oe={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},Te={class:"text-3xl font-bold text-gray-900"},$e={class:"w-[180px] h-[180px] bg-red-200 border-4 border-white rounded-2xl shadow-xl flex flex-col items-center justify-center text-center hover:scale-105 transition-transform duration-300"},ze={class:"text-3xl font-bold text-gray-900"},Ge={class:"py-8 px-4 md:px-6 lg:px-8 max-w-7xl mx-auto"},qe={class:"flex flex-col md:flex-row gap-6"},He={class:"flex-1 bg-white dark:bg-gray-800 p-6 rounded-xl shadow border-2 border-red-400"},Je={class:"flex-1 bg-white dark:bg-gray-800 p-6 rounded-xl shadow border-2 border-red-400"},Qe={class:"flex items-center justify-between mb-4"},Xe={class:"min-w-full text-sm"},Ke={class:"divide-y divide-gray-200"},We=["onClick"],Ze={class:"py-2 text-gray-800 dark:text-gray-100"},Ye={class:"py-2 text-gray-800 dark:text-gray-100"},et={class:"py-2 text-gray-600 dark:text-gray-300"},tt={class:"py-2"},st={key:0,class:"fixed top-0 right-0 w-full md:w-1/3 h-full bg-white dark:bg-gray-900 p-6 z-50 shadow-xl shadow-red-200 transition duration-300 ease-in-out overflow-y-auto"},at={class:"text-gray-800 dark:text-gray-200 font-medium"},ot={class:"text-gray-700 dark:text-gray-400"},rt={class:"mt-3 p-2 border rounded bg-gray-100 dark:bg-gray-800"},lt={class:"text-sm text-gray-800 dark:text-gray-300"},nt={class:"mt-3 flex space-x-2 justify-end"},it={key:0,class:"mt-2"},dt={key:1,class:"mt-2 flex justify-end"},ct={class:"mt-3 text-sm"},ut={class:"grid grid-cols-3 gap-2"},pt={class:"flex items-center space-x-2 w-full"},xt=["id","onUpdate:modelValue"],mt=["for"],ft={class:"w-full"},gt=["src","onClick"],bt={key:1,class:"h-16 flex items-center justify-center text-[10px] italic text-gray-400 border rounded"},vt={key:0,class:"mt-4"},ht={class:"border-l-2 border-red-400 pl-3 space-y-2"},yt={class:"text-sm font-semibold text-gray-900 dark:text-white"},wt={key:0,class:"text-xs text-gray-500 italic"},_t={class:"text-xs text-gray-400"},kt={key:0,class:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-4 py-2 rounded shadow-lg z-50"},Ct=["src"],Mt={__name:"MedicalDashboard",props:{user:Object,allUsers:Array,summary:{type:Object,default:()=>({total:0,accepted:0,pending:0,returned:0})}},setup(W){ke.register(Ce,Me,je,Ee,Fe,Ue,Ae,Le);const Z=me(),y=d(Z.props.users||[]),w=W,l=d(null),Y=d(!0),ee=d(""),M=d(""),_=d({});d("");const v=d({visible:!1,message:""}),L=(s,t=3e3)=>{v.value.message=s,v.value.visible=!0,setTimeout(()=>{v.value.visible=!1},t)},te={labels:["Jan","Feb","Mar","Apr","May","Jun"],datasets:[{label:"Submitted",data:[5,20,35,50,70,90],borderColor:"#2563EB",backgroundColor:"rgba(37, 99, 235, 0.2)",tension:.4},{label:"Accepted",data:[2,10,15,25,40,60],borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.2)",tension:.4}]},se=s=>{const t=(s||"").toLowerCase();return t==="accepted"?"bg-green-100 text-green-700":t==="pending"?"bg-yellow-100 text-yellow-700":t==="rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"},j=async()=>{try{const s=await fetch("/medical-dashboard/applicants",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error("Failed to fetch users");y.value=await s.json()}catch(s){ee.value=s.message}finally{Y.value=!1}};fe(()=>{j(),S()});const ae=J(()=>M.value.trim()?y.value.filter(s=>s.name?s.name.toLowerCase().includes(M.value.toLowerCase()):!1):y.value),oe=J(()=>M.value.trim()?ae.value:y.value.slice(0,4)),B=async s=>{var t,x;try{const i=await axios.get(`/medical-dashboard/application/${s.id}`);l.value={...s,application:{...i.data.user.application,processes:((t=i.data.user.application)==null?void 0:t.processes)||[],program:((x=i.data.user.application)==null?void 0:x.program)||null},grades:i.data.user.grades||null},_.value=i.data.uploadedFiles||{},console.log("Full user data:",i.data.user),console.log("Grades check:",i.data.user.grades),await S(),console.log("User & files:",l.value,_.value)}catch(i){console.error("Failed to fetch user data:",i),_.value={},l.value=null}},re=()=>{l.value=null},le=s=>({file10Front:"Grade 10 Front",file11:"Grade 11 Report",file12:"Grade 12 Report",schoolId:"School ID",nonEnrollCert:"Certificate of Non-Enrollment",psa:"PSA Birth Certificate",goodMoral:"Good Moral Certificate",underOath:"Under Oath Document",photo2x2:"2x2 Photo"})[s]||s,N=d(null),E=d(!1),ne=s=>{N.value=s,E.value=!0},R=()=>{E.value=!1},p=d(!1),f=d({}),g=d(""),ie=()=>{p.value=!0,f.value=[],g.value=""},de=()=>{p.value=!1,f.value=[],g.value=""},ce=async()=>{const s=Object.keys(f.value).filter(t=>f.value[t]);if(s.length===0||!g.value.trim()){alert("Please select files and enter a return note.");return}try{await axios.post(`/medical/return-files/${l.value.id}`,{files:s,note:g.value.trim()}),alert("Files returned and application status logged."),p.value=!1,f.value={},g.value="",await j(),await B(l.value)}catch(t){console.error(t),alert("Return failed.")}},D=s=>typeof s=="string"?s.charAt(0).toUpperCase()+s.slice(1):"",ue=s=>new Date(s).toLocaleString(),pe=async()=>{var s,t;try{await axios.post(`/medical-dashboard/accept/${l.value.id}`),L("Application cleared."),l.value=null,await j()}catch(x){console.error("Accept failed:",x);const i=((t=(s=x.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to accept application due to an unexpected error.";L(i)}},xe=d([]),S=async()=>{try{const s=await axios.get("/interviewer-dashboard/programs");xe.value=s.data.programs}catch(s){console.error("Failed to load programs",s)}};return(s,t)=>(r(),o(C,null,[b(h(ge),{title:"Medical Dashboard"}),b(_e,null,{default:k(()=>{var x,i,I,P;return[e("div",De,[e("div",Se,[t[1]||(t[1]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7h18M3 12h18M3 17h18"})])],-1)),t[2]||(t[2]=e("p",{class:"text-gray-700 text-base font-medium"}," Total Applications ",-1)),e("p",Ie,a(((x=w.summary)==null?void 0:x.total)??0),1)]),e("div",Pe,[t[3]||(t[3]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),t[4]||(t[4]=e("p",{class:"text-gray-700 text-base font-medium"},"Accepted",-1)),e("p",Ve,a(((i=w.summary)==null?void 0:i.accepted)??0),1)]),e("div",Oe,[t[5]||(t[5]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3"})])],-1)),t[6]||(t[6]=e("p",{class:"text-gray-700 text-base font-medium"},"Pending",-1)),e("p",Te,a(((I=w.summary)==null?void 0:I.pending)??0),1)]),e("div",$e,[t[7]||(t[7]=e("div",{class:"bg-[#9E122C] p-4 rounded-full mb-3"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),t[8]||(t[8]=e("p",{class:"text-gray-700 text-base font-medium"},"Returned",-1)),e("p",ze,a(((P=w.summary)==null?void 0:P.returned)??0),1)])]),e("div",Ge,[e("div",qe,[e("div",He,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," Applications Overview ",-1)),b(h(we),{"chart-data":te,class:"h-60 w-full"})]),e("div",Je,[e("div",Qe,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Recent Applications ",-1)),b(h(be),{href:"/medical-applications",class:"text-sm text-[#9E122C] hover:underline hover:text-[#b51834] transition"},{default:k(()=>t[10]||(t[10]=[U(" See all ")])),_:1,__:[10]})]),e("table",Xe,[t[12]||(t[12]=e("thead",null,[e("tr",null,[e("th",{class:"text-left text-gray-500 pb-2"}," Last Name "),e("th",{class:"text-left text-gray-500 pb-2"}," First Name "),e("th",{class:"text-left text-gray-500 pb-2"}," Course "),e("th",{class:"text-left text-gray-500 pb-2"}," Status ")])],-1)),e("tbody",Ke,[(r(!0),o(C,null,A(oe.value,c=>(r(),o("tr",{key:c.id,onClick:F=>B(c),class:"cursor-pointer hover:bg-[#FBCB77]"},[e("td",Ze,a(c.lastname),1),e("td",Ye,a(c.firstname),1),e("td",et,a(c.program.code||"—"),1),e("td",tt,[e("span",{class:Q([se(c.status),"px-2 py-1 rounded text-xs font-semibold"])},a(c.status||"Unknown"),3)])],8,We))),128))])])])]),b(X,{name:"slide-fade"},{default:k(()=>{var c,F,V,O,T,$,z,G,q;return[l.value?(r(),o("div",st,[e("button",{class:"mt-6 px-4 py-2 rounded bg-[#9E122C] text-white hover:bg-[#EE6A43] transition",onClick:re}," Close "),t[19]||(t[19]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," User Information ",-1)),e("p",at," Name: "+a(l.value.lastname)+", "+a(l.value.firstname),1),e("p",ot," Email: "+a(l.value.email),1),e("div",rt,[t[13]||(t[13]=e("h4",{class:"text-sm font-bold text-gray-700 dark:text-white mb-1"}," Current Program: ",-1)),e("p",lt,a((V=(F=(c=l.value)==null?void 0:c.application)==null?void 0:F.program)==null?void 0:V.code)+" - "+a(($=(T=(O=l.value)==null?void 0:O.application)==null?void 0:T.program)==null?void 0:$.name),1)]),e("div",nt,[p.value?u("",!0):(r(),o("button",{key:0,onClick:ie,class:"px-3 py-1 text-gray-600 text-l rounded hover:text-yellow-700"},[b(h(Be),{icon:h(Ne)},null,8,["icon"]),t[14]||(t[14]=U(" Actions "))])),p.value?(r(),o("button",{key:1,onClick:de,class:"px-3 py-1 bg-gray-400 text-black text-sm rounded hover:bg-gray-500"}," Cancel ")):u("",!0)]),p.value?(r(),o("div",it,[t[15]||(t[15]=e("label",{for:"returnNote",class:"block text-xs font-semibold mb-1"}," Return Reason / Note ",-1)),K(e("textarea",{id:"returnNote","onUpdate:modelValue":t[0]||(t[0]=n=>g.value=n),rows:"2",class:"w-full border rounded p-1 text-xs",placeholder:"Reason for returning..."},null,512),[[ve,g.value]])])):u("",!0),p.value?(r(),o("div",dt,[e("button",{onClick:ce,class:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700"}," Return Selected Files "),e("button",{onClick:pe,class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"}," Clear Medical ")])):u("",!0),e("section",ct,[t[18]||(t[18]=e("h4",{class:"font-semibold mb-1 text-base"}," Uploaded Documents ",-1)),e("div",ut,[(r(!0),o(C,null,A(_.value,(n,m)=>(r(),o("div",{key:m,class:"flex flex-col items-start space-y-1"},[e("div",pt,[p.value?K((r(),o("input",{key:0,type:"checkbox",id:m,"onUpdate:modelValue":H=>f.value[m]=H,class:"h-4 w-4 mt-1"},null,8,xt)),[[he,f.value[m]]]):u("",!0),e("label",{for:m,class:"text-xs font-medium truncate w-full"},a(le(m)),9,mt)]),e("div",ft,[n?(r(),o("img",{key:0,src:n,alt:"Uploaded Document",class:"h-16 w-full object-contain border rounded cursor-pointer",onClick:H=>ne(n)},null,8,gt)):(r(),o("div",bt," No Image "))])]))),128))]),(q=(G=(z=l.value)==null?void 0:z.application)==null?void 0:G.processes)!=null&&q.length?(r(),o("section",vt,[t[17]||(t[17]=e("h4",{class:"font-semibold mb-2 text-base text-gray-800 dark:text-gray-200"}," Application History ",-1)),e("ul",ht,[(r(!0),o(C,null,A(l.value.application.processes,(n,m)=>(r(),o("li",{key:m,class:"relative"},[t[16]||(t[16]=e("div",{class:"absolute -left-[10px] top-1 w-3 h-3 bg-red-600 rounded-full border-2 border-white"},null,-1)),e("p",yt,[U(a(D(n.stage))+" - ",1),e("span",{class:Q({"text-green-600":n.status==="completed","text-yellow-600":n.status==="in_progress","text-red-600":n.status==="returned"})},a(D(n.status)),3)]),n.notes?(r(),o("p",wt," Note: "+a(n.notes)+" By: "+a(n.performed_by.firstname)+" "+a(n.performed_by.lastname),1)):u("",!0),e("p",_t,a(ue(n.created_at)),1)]))),128))])])):u("",!0)])])):u("",!0)]}),_:1}),b(X,{name:"fade"},{default:k(()=>[v.value.visible?(r(),o("div",kt,a(v.value.message),1)):u("",!0)]),_:1}),E.value?(r(),o("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",onClick:ye(R,["self"])},[e("img",{src:N.value,alt:"Preview",class:"max-w-full max-h-full rounded shadow-lg"},null,8,Ct),e("button",{onClick:R,class:"absolute top-5 right-5 text-white text-4xl font-bold hover:text-gray-300","aria-label":"Close preview"}," × ")])):u("",!0)])]}),_:1})],64))}},Rt=Re(Mt,[["__scopeId","data-v-e921933e"]]);export{Rt as default};
