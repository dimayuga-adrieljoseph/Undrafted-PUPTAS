import{l as de,r as i,j as ie,i as F,z as re,k as ue,d as s,o as a,e as y,b as pe,a as l,t as n,F as I,f as u,h as W,s as X,g as Z,n as ve,w as ge,m as me}from"./app-Db2MWlaG.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";const be={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},fe={class:"bg-gradient-to-br from-orange-200 to-red-400 dark:bg-gray-900 rounded-lg shadow-lg max-w-5xl w-full p-6 overflow-auto max-h-[90vh] relative",style:{"min-width":"700px"}},ye={key:0},xe={key:1,class:"text-red-600 dark:text-red-400"},ke={class:"grid grid-cols-2 gap-8"},he={class:"mt-6"},we={class:"mt-4"},Ce=["value"],Fe={class:"mt-4"},Ie=["value","disabled"],Se={class:"grid grid-cols-3 gap-2"},Me={class:"image-wrapper"},$e=["src"],Ne={key:1,class:"placeholder"},Re=["disabled"],_e={class:"image-wrapper"},Ae=["src"],je={key:1,class:"placeholder"},Ee=["disabled"],Pe={class:"image-wrapper"},Ue=["src"],De={key:1,class:"placeholder"},Ge=["disabled"],Oe={class:"image-wrapper"},Be=["src"],ze={key:1,class:"placeholder"},Te=["disabled"],Ve={class:"image-wrapper"},Ye=["src"],He={key:1,class:"placeholder"},Le=["disabled"],qe={class:"image-wrapper"},Je=["src"],Ke={key:1,class:"placeholder"},Qe=["disabled"],We={class:"image-wrapper"},Xe=["src"],Ze={key:1,class:"placeholder"},el=["disabled"],ll={class:"image-wrapper"},tl=["src"],ol={key:1,class:"placeholder"},sl=["disabled"],al={class:"image-wrapper"},nl=["src"],dl={key:1,class:"placeholder"},il=["disabled"],rl={class:"image-wrapper"},ul=["src"],pl={key:1,class:"placeholder"},vl=["disabled"],gl={class:"flex justify-end space-x-4 mt-6"},ml=["disabled"],cl={key:0,class:"text-sm text-gray-600 mt-2"},bl={key:3},fl={key:2,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50"},yl=["src"],xl={key:0,class:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-4 py-2 rounded shadow-lg z-50"},kl={__name:"ApplicationReviewModal",props:{show:Boolean,userEmail:String},emits:["close","reupload"],setup(ee,{emit:le}){const te=ee,oe=le;de(()=>te.show,async d=>{d&&await C()});const b=i(""),x=i(""),k=i(!1),S=i(!1),h=i(""),o=i(null),f=i({visible:!1,message:""}),w=(d,e=3e3)=>{f.value.message=d,f.value.visible=!0,setTimeout(()=>{f.value.visible=!1},e)},r=ie(()=>{var e;const d=(e=o.value)==null?void 0:e.status;return!d||["draft","returned"].includes(d)}),C=async()=>{var d;S.value=!0,h.value="";try{const e=await F.get("/user/application");o.value=e.data,console.log("Application status:",(d=o.value)==null?void 0:d.status),await ne(),console.log("Setting selected:",e.data.program_id),re(()=>{b.value=e.data.program_id??"",x.value=e.data.second_choice_id??""})}catch{h.value="Failed to load application data."}finally{S.value=!1}},_=()=>{k.value=!0,C()},M=()=>{k.value=!1},se=async()=>{try{await F.post("/user/application/submit",{program_id:b.value,second_choice_id:x.value||null}),await C(),oe("refreshDashboard"),w("Application submitted!"),setTimeout(()=>{M()},1e3)}catch{w("Failed to submit application.")}};ue(()=>{_(),ae.value={file10Front:null,file11:null,file12:null,schoolId:null,nonEnrollCert:null,psa:null,goodMoral:null,underOath:null,photo2x2:null}});const A=i(null),$=i(!1),p=d=>{A.value=d,$.value=!0},j=()=>{$.value=!1},ae=i({}),E=i(null),P=i(null),U=i(null),D=i(null),G=i(null),O=i(null),B=i(null),z=i(null),T=i(null),v=d=>{var c,m;(m=(c={file10Front:E,file11:P,file12:U,schoolId:D,nonEnrollCert:G,psa:O,goodMoral:B,underOath:z,photo2x2:T}[d])==null?void 0:c.value)==null||m.click()},g=async(d,e)=>{const c=d.target.files[0];if(!c)return;const m=new FormData;m.append("file",c),m.append("field",e);try{await F.post("/user/application/reupload",m),w("File reuploaded!"),C()}catch{w("Failed to reupload file.")}},N=i([]),ne=async()=>{try{const d=await F.get("/user/eligible-programs");N.value=d.data.programs}catch{console.error("Failed to load eligible programs")}};return(d,e)=>{var c,m,R,V,Y,H,L,q,J,K,Q;return a(),s(I,null,[k.value?(a(),s("div",be,[l("div",fe,[l("button",{onClick:M,class:"absolute top-3 right-3 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white text-3xl font-bold","aria-label":"Close modal"}," × "),S.value?(a(),s("p",ye,"Loading application data...")):h.value?(a(),s("p",xe,n(h.value),1)):o.value?(a(),s(I,{key:2},[e[63]||(e[63]=l("h2",{class:"text-xl font-bold mb-4 text-gray-900 dark:text-white"}," Review Your Application ",-1)),l("div",ke,[l("div",null,[l("section",null,[e[38]||(e[38]=l("h3",{class:"font-semibold mb-2 text-gray-800 dark:text-gray-300"}," Personal Details ",-1)),l("p",null,[e[32]||(e[32]=l("strong",null,"Name:",-1)),u(" "+n(o.value.firstname)+" "+n(o.value.middlename)+" "+n(o.value.lastname),1)]),l("p",null,[e[33]||(e[33]=l("strong",null,"Birthday:",-1)),u(" "+n(o.value.birthday),1)]),l("p",null,[e[34]||(e[34]=l("strong",null,"Sex/Gender:",-1)),u(" "+n(o.value.sex),1)]),l("p",null,[e[35]||(e[35]=l("strong",null,"Contact Number:",-1)),u(" +63"+n(o.value.contactnumber),1)]),l("p",null,[e[36]||(e[36]=l("strong",null,"Address:",-1)),u(" "+n(o.value.address),1)]),l("p",null,[e[37]||(e[37]=l("strong",null,"Email:",-1)),u(" "+n(o.value.email),1)])]),l("section",he,[e[45]||(e[45]=l("h3",{class:"font-semibold mb-2 text-gray-800 dark:text-gray-300"}," High School Details ",-1)),l("p",null,[e[39]||(e[39]=l("strong",null,"School:",-1)),u(" "+n(o.value.school),1)]),l("p",null,[e[40]||(e[40]=l("strong",null,"School Address:",-1)),u(" "+n(o.value.schoolAdd),1)]),l("p",null,[e[41]||(e[41]=l("strong",null,"School Year:",-1)),u(" "+n(o.value.schoolyear),1)]),l("p",null,[e[42]||(e[42]=l("strong",null,"Date Graduated:",-1)),u(" "+n(o.value.dateGrad),1)]),l("p",null,[e[43]||(e[43]=l("strong",null,"Strand:",-1)),u(" "+n(o.value.strand),1)]),l("p",null,[e[44]||(e[44]=l("strong",null,"Track:",-1)),u(" "+n(o.value.track),1)])]),l("div",we,[e[47]||(e[47]=l("label",{for:"programSelect",class:"block text-sm font-medium text-gray-700"}," Choose Your Program ",-1)),W(l("select",{id:"programSelect","onUpdate:modelValue":e[0]||(e[0]=t=>b.value=t),class:"mt-1 block w-full rounded border-gray-300 shadow-sm"},[e[46]||(e[46]=l("option",{value:""},"-- Select Program --",-1)),(a(!0),s(I,null,Z(N.value,t=>(a(),s("option",{key:t.id,value:t.id},n(t.name)+" ("+n(t.code)+") ",9,Ce))),128))],512),[[X,b.value]])]),l("div",Fe,[e[49]||(e[49]=l("label",{for:"secondProgramSelect",class:"block text-sm font-medium text-gray-700"}," Choose Your Second Program ",-1)),W(l("select",{id:"secondProgramSelect","onUpdate:modelValue":e[1]||(e[1]=t=>x.value=t),class:"mt-1 block w-full rounded border-gray-300 shadow-sm"},[e[48]||(e[48]=l("option",{value:""},"-- Select Program --",-1)),(a(!0),s(I,null,Z(N.value,t=>(a(),s("option",{key:t.id,value:t.id,disabled:t.id===b.value},n(t.name)+" ("+n(t.code)+") ",9,Ie))),128))],512),[[X,x.value]])])]),l("section",null,[e[60]||(e[60]=l("h3",{class:"font-semibold mb-2 text-gray-800 dark:text-gray-300"}," Uploaded Documents ",-1)),l("div",Se,[l("div",Me,[e[50]||(e[50]=l("p",null,"Grade 10 Front:",-1)),o.value.uploadedFiles.file10Front?(a(),s("img",{key:0,src:(c=o.value.uploadedFiles.file10Front)==null?void 0:c.url,alt:"Grade 10 Front",class:"max-h-20 object-contain border rounded",onClick:e[2]||(e[2]=t=>p(o.value.uploadedFiles.file10Front))},null,8,$e)):(a(),s("div",Ne," No Image Uploaded ")),l("input",{type:"file",ref_key:"file10FrontInput",ref:E,style:{display:"none"},accept:"image/*,.pdf",onChange:e[3]||(e[3]=t=>g(t,"file10Front"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[4]||(e[4]=t=>v("file10Front")),disabled:!r.value}," Reupload ",8,Re)]),l("div",_e,[e[51]||(e[51]=l("p",null,"Grade 10 Back:",-1)),o.value.uploadedFiles.file10_back?(a(),s("img",{key:0,src:(m=o.value.uploadedFiles.file10_back)==null?void 0:m.url,alt:"Grade 10 Front",class:"max-h-20 object-contain border rounded",onClick:e[5]||(e[5]=t=>p(o.value.uploadedFiles.file10_back))},null,8,Ae)):(a(),s("div",je," No Image Uploaded ")),l("input",{type:"file",ref:"fileInput",style:{display:"none"},accept:"image/*,.pdf",onChange:e[6]||(e[6]=t=>g(t,"file"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[7]||(e[7]=t=>v("file")),disabled:!r.value}," Reupload ",8,Ee)]),l("div",Pe,[e[52]||(e[52]=l("p",null,"Grade 11 Report:",-1)),o.value.uploadedFiles.file11?(a(),s("img",{key:0,src:(R=o.value.uploadedFiles.file11)==null?void 0:R.url,alt:"Grade 11 Report",class:"max-h-20 object-contain border rounded",onClick:e[8]||(e[8]=t=>p(o.value.uploadedFiles.file11))},null,8,Ue)):(a(),s("div",De," No Image Uploaded ")),l("input",{type:"file",ref_key:"file11Input",ref:P,style:{display:"none"},accept:"image/*,.pdf",onChange:e[9]||(e[9]=t=>g(t,"file11"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[10]||(e[10]=t=>v("file11")),disabled:!r.value}," Reupload ",8,Ge)]),l("div",Oe,[e[53]||(e[53]=l("p",null,"Grade 12 Report:",-1)),o.value.uploadedFiles.file12?(a(),s("img",{key:0,src:(V=o.value.uploadedFiles.file12)==null?void 0:V.url,alt:"Grade 12 Report",class:"max-h-20 object-contain border rounded",onClick:e[11]||(e[11]=t=>p(o.value.uploadedFiles.file12))},null,8,Be)):(a(),s("div",ze," No Image Uploaded ")),l("input",{type:"file",ref_key:"file12Input",ref:U,style:{display:"none"},accept:"image/*,.pdf",onChange:e[12]||(e[12]=t=>g(t,"file12"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[13]||(e[13]=t=>v("file12")),disabled:!r.value}," Reupload ",8,Te)]),l("div",Ve,[e[54]||(e[54]=l("p",null,"School ID:",-1)),o.value.uploadedFiles.schoolId?(a(),s("img",{key:0,src:(Y=o.value.uploadedFiles.schoolId)==null?void 0:Y.url,alt:"School ID",class:"max-h-20 object-contain border rounded",onClick:e[14]||(e[14]=t=>p(o.value.uploadedFiles.schoolId))},null,8,Ye)):(a(),s("div",He," No Image Uploaded ")),l("input",{type:"file",ref_key:"schoolIdInput",ref:D,style:{display:"none"},accept:"image/*,.pdf",onChange:e[15]||(e[15]=t=>g(t,"schoolId"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[16]||(e[16]=t=>v("schoolId")),disabled:!r.value}," Reupload ",8,Le)]),l("div",qe,[e[55]||(e[55]=l("p",null,"Certificate of Non-Enrollment:",-1)),o.value.uploadedFiles.nonEnrollCert?(a(),s("img",{key:0,src:(H=o.value.uploadedFiles.nonEnrollCert)==null?void 0:H.url,alt:"Non-Enrollment Certificate",class:"max-h-20 object-contain border rounded",onClick:e[17]||(e[17]=t=>p(o.value.uploadedFiles.nonEnrollCert))},null,8,Je)):(a(),s("div",Ke," No Image Uploaded ")),l("input",{type:"file",ref_key:"nonEnrollCertInput",ref:G,style:{display:"none"},accept:"image/*,.pdf",onChange:e[18]||(e[18]=t=>g(t,"nonEnrollCert"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[19]||(e[19]=t=>v("nonEnrollCert")),disabled:!r.value}," Reupload ",8,Qe)]),l("div",We,[e[56]||(e[56]=l("p",null,"PSA Birth Certificate:",-1)),o.value.uploadedFiles.psa?(a(),s("img",{key:0,src:(L=o.value.uploadedFiles.psa)==null?void 0:L.url,alt:"PSA",class:"max-h-20 object-contain border rounded",onClick:e[20]||(e[20]=t=>p(o.value.uploadedFiles.psa))},null,8,Xe)):(a(),s("div",Ze," No Image Uploaded ")),l("input",{type:"file",ref_key:"psaInput",ref:O,style:{display:"none"},accept:"image/*,.pdf",onChange:e[21]||(e[21]=t=>g(t,"psa"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[22]||(e[22]=t=>v("psa")),disabled:!r.value}," Reupload ",8,el)]),l("div",ll,[e[57]||(e[57]=l("p",null,"Good Moral Certificate:",-1)),o.value.uploadedFiles.goodMoral?(a(),s("img",{key:0,src:(q=o.value.uploadedFiles.goodMoral)==null?void 0:q.url,alt:"Good Moral",class:"max-h-20 object-contain border rounded",onClick:e[23]||(e[23]=t=>p(o.value.uploadedFiles.goodMoral))},null,8,tl)):(a(),s("div",ol," No Image Uploaded ")),l("input",{type:"file",ref_key:"goodMoralInput",ref:B,style:{display:"none"},accept:"image/*,.pdf",onChange:e[24]||(e[24]=t=>g(t,"goodMoral"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[25]||(e[25]=t=>v("goodMoral")),disabled:!r.value}," Reupload ",8,sl)]),l("div",al,[e[58]||(e[58]=l("p",null,"Under Oath Document:",-1)),o.value.uploadedFiles.underOath?(a(),s("img",{key:0,src:(J=o.value.uploadedFiles.underOath)==null?void 0:J.url,alt:"Under Oath",class:"max-h-20 object-contain border rounded",onClick:e[26]||(e[26]=t=>p(o.value.uploadedFiles.underOath))},null,8,nl)):(a(),s("div",dl," No Image Uploaded ")),l("input",{type:"file",ref_key:"underOathInput",ref:z,style:{display:"none"},accept:"image/*,.pdf",onChange:e[27]||(e[27]=t=>g(t,"underOath"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[28]||(e[28]=t=>v("underOath")),disabled:!r.value}," Reupload ",8,il)]),l("div",rl,[e[59]||(e[59]=l("p",null,"2x2 Photo:",-1)),o.value.uploadedFiles.photo2x2?(a(),s("img",{key:0,src:(K=o.value.uploadedFiles.photo2x2)==null?void 0:K.url,alt:"2x2 Photo",class:"max-h-20 object-contain border rounded",onClick:e[29]||(e[29]=t=>p(o.value.uploadedFiles.photo2x2))},null,8,ul)):(a(),s("div",pl," No Image Uploaded ")),l("input",{type:"file",ref_key:"photo2x2Input",ref:T,style:{display:"none"},accept:"image/*,.pdf",onChange:e[30]||(e[30]=t=>g(t,"photo2x2"))},null,544),l("button",{class:"mt-1 px-2 py-1 bg-white/50 text-black text-xs rounded hover:bg-red-400",onClick:e[31]||(e[31]=t=>v("photo2x2")),disabled:!r.value}," Reupload ",8,vl)])])])]),l("div",gl,[l("button",{onClick:M,class:"px-4 py-2 bg-gray-400 rounded hover:bg-gray-500 text-gray-800"}," Cancel "),l("button",{disabled:!r.value,onClick:se,class:ve(["px-4 py-2 rounded text-white",{"bg-gray-400 cursor-not-allowed":!r.value,"bg-maroon-700 hover:bg-maroon-900":r.value}])}," Submit Application ",10,ml),(Q=o.value)!=null&&Q.status&&!r.value?(a(),s("p",cl,[e[61]||(e[61]=u(" Application already ")),l("strong",null,n(o.value.status),1),e[62]||(e[62]=u(". "))])):y("",!0)])],64)):(a(),s("p",bl,"No application data found."))])])):y("",!0),k.value?y("",!0):(a(),s("button",{key:1,onClick:_,"aria-label":"Open Application Modal",class:"fixed bottom-8 right-8 bg-maroon-700 hover:bg-maroon-900 text-white p-8 rounded-full shadow-lg focus:outline-none",title:"Review Application"},e[64]||(e[64]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]))),$.value?(a(),s("div",fl,[l("img",{src:A.value,alt:"Preview",class:"max-w-full max-h-full rounded shadow-lg",onClick:j},null,8,yl),l("button",{onClick:j,class:"absolute top-5 right-5 text-white text-4xl font-bold hover:text-gray-300","aria-label":"Close preview"}," × ")])):y("",!0),pe(me,{name:"fade"},{default:ge(()=>[f.value.visible?(a(),s("div",xl,n(f.value.message),1)):y("",!0)]),_:1})],64)}}},Cl=ce(kl,[["__scopeId","data-v-eb71a23d"]]);export{Cl as default};
